<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaxiBF - Dashboard Taxista</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --taxi-yellow: #FFC400;
            --dark-graphite: #1C1C1C;
            --white: #FFFFFF;
            --light-gray: #F5F5F5;
            --available: #2ECC71;
            --busy: #E74C3C;
            --offline: #9E9E9E;
            --verified: #3498db;
            --pending: #f39c12;
            --expired: #95a5a6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--light-gray);
            color: var(--dark-graphite);
        }

        /* Navbar */
        .navbar {
            background: var(--white);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        .logo img {
            height: 50px;
            width: auto;
            object-fit: contain;
            transform: scale(2.5);
            margin-left: 15px;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: color 0.3s;
            position: relative;
        }

        .nav-item:hover, .nav-item.active {
            color: var(--dark-graphite);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--taxi-yellow);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-profile-menu {
            position: relative;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--dark-graphite);
            cursor: pointer;
            border: 3px solid var(--white);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s;
            position: relative;
        }

        .user-avatar:hover {
            transform: scale(1.05);
        }

        .user-avatar.verified::after {
            content: '‚úì';
            position: absolute;
            bottom: -2px;
            right: -2px;
            background: var(--verified);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--white);
        }

        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            min-width: 250px;
            display: none;
            z-index: 1001;
            overflow: hidden;
            margin-top: 10px;
        }

        .profile-dropdown.active {
            display: block;
        }

        .dropdown-header {
            padding: 1.5rem;
            background: var(--light-gray);
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .dropdown-user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .dropdown-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--dark-graphite);
        }

        .dropdown-user-details h4 {
            font-size: 1rem;
            margin-bottom: 0.3rem;
        }

        .dropdown-user-details p {
            font-size: 0.85rem;
            color: #666;
        }

        .dropdown-menu {
            padding: 0.5rem 0;
        }

        .dropdown-item {
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
            color: var(--dark-graphite);
            transition: all 0.3s;
            cursor: pointer;
        }

        .dropdown-item:hover {
            background: var(--light-gray);
            padding-left: 2rem;
        }

        .dropdown-item i {
            color: var(--taxi-yellow);
            width: 20px;
        }

        .dropdown-divider {
            height: 1px;
            background: rgba(0,0,0,0.1);
            margin: 0.5rem 0;
        }

        .btn-logout {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 1.3rem;
            transition: color 0.3s;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-logout:hover {
            color: var(--busy);
            background: rgba(231, 76, 60, 0.1);
        }

        /* Main Content */
        .main-content {
            margin-top: 100px;
            padding: 2rem;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 2rem;
        }

        /* Status Card */
        .status-card {
            background: var(--white);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .status-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark-graphite);
        }

        .verified-badge {
            background: rgba(52, 152, 219, 0.1);
            color: var(--verified);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .verified-badge i {
            font-size: 0.9rem;
        }

        .pending-badge {
            background: rgba(243, 156, 18, 0.1);
            color: var(--pending);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .expired-badge {
            background: rgba(149, 165, 166, 0.1);
            color: var(--expired);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Status Selector */
        .status-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .status-btn {
            padding: 1.2rem 0.5rem;
            border-radius: 15px;
            border: 2px solid #e8e8e8;
            background: var(--white);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .status-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .status-btn.active {
            border-color: var(--taxi-yellow);
            background: rgba(255, 196, 0, 0.1);
        }

        .status-btn.available.active {
            border-color: var(--available);
            background: rgba(46, 204, 113, 0.1);
        }

        .status-btn.busy.active {
            border-color: var(--busy);
            background: rgba(231, 76, 60, 0.1);
        }

        .status-btn.offline.active {
            border-color: var(--offline);
            background: rgba(158, 158, 158, 0.1);
        }

        .status-icon {
            font-size: 1.8rem;
        }

        .status-btn.available .status-icon { color: var(--available); }
        .status-btn.busy .status-icon { color: var(--busy); }
        .status-btn.offline .status-icon { color: var(--offline); }

        /* Credentials */
        .credentials {
            background: var(--light-gray);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .credential-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .credential-item:last-child {
            border-bottom: none;
        }

        .credential-label {
            font-size: 0.9rem;
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .credential-label i {
            color: var(--taxi-yellow);
        }

        .credential-value {
            font-weight: 700;
            color: var(--dark-graphite);
            font-size: 0.95rem;
        }

        .credential-value.loading {
            color: #999;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.4; }
            50% { opacity: 0.8; }
            100% { opacity: 0.4; }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            background: var(--light-gray);
            border-radius: 15px;
            padding: 1.2rem;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            background: rgba(255, 196, 0, 0.1);
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--dark-graphite);
            margin-bottom: 0.3rem;
            min-height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-value.loading {
            color: #999;
            animation: pulse 1.5s infinite;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #666;
            font-weight: 600;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .action-btn {
            padding: 1.2rem 0.5rem;
            border-radius: 15px;
            border: 2px solid #e8e8e8;
            background: var(--white);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
        }

        .action-btn:hover {
            border-color: var(--taxi-yellow);
            background: rgba(255, 196, 0, 0.1);
            transform: translateY(-2px);
        }

        .action-btn i {
            font-size: 1.5rem;
            color: var(--taxi-yellow);
        }

        .action-btn span {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--dark-graphite);
        }

        /* Map Section */
        .map-container {
            background: var(--white);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: 600px;
            position: relative;
        }

        .map-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e0e0e0 0%, #f0f0f0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: #666;
        }

        .map-placeholder i {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            color: var(--taxi-yellow);
            opacity: 0.7;
        }

        .map-placeholder p {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .map-placeholder small {
            font-size: 0.9rem;
            color: #999;
        }

        .map-controls {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            right: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .gps-status {
            background: var(--white);
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-weight: 600;
            color: var(--dark-graphite);
        }

        .gps-status.active {
            color: var(--available);
        }

        .gps-status.inactive {
            color: var(--offline);
        }

        .location-btn {
            background: var(--taxi-yellow);
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(255, 196, 0, 0.4);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-graphite);
        }

        .location-btn:hover {
            transform: scale(1.1);
        }

        .location-btn i {
            font-size: 1.5rem;
        }

        /* Subscription Card */
        .subscription-card {
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            border-radius: 20px;
            padding: 1.8rem;
            margin-top: 1.5rem;
            color: var(--dark-graphite);
            box-shadow: 0 4px 20px rgba(255, 196, 0, 0.3);
        }

        .subscription-card.no-subscription {
            background: linear-gradient(135deg, var(--light-gray), #e8e8e8);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .subscription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .subscription-title {
            font-size: 1.3rem;
            font-weight: 800;
        }

        .subscription-status {
            background: var(--dark-graphite);
            color: var(--white);
            padding: 0.4rem 1.2rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .subscription-status.active {
            background: var(--available);
        }

        .subscription-status.pending {
            background: var(--pending);
        }

        .subscription-status.expired {
            background: var(--expired);
        }

        .subscription-details {
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .btn-subscription {
            background: var(--dark-graphite);
            color: var(--white);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-subscription:hover {
            background: #000;
            transform: translateY(-2px);
        }

        .btn-subscription.primary {
            background: var(--taxi-yellow);
            color: var(--dark-graphite);
        }

        .btn-subscription.primary:hover {
            background: #ffb100;
        }

        /* Alert Card */
        .alert-card {
            background: rgba(231, 76, 60, 0.1);
            border: 2px solid var(--busy);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: none;
            align-items: center;
            gap: 1rem;
        }

        .alert-icon {
            color: var(--busy);
            font-size: 1.5rem;
        }

        .alert-content h4 {
            color: var(--busy);
            margin-bottom: 0.3rem;
        }

        .alert-content p {
            font-size: 0.9rem;
            color: #666;
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--dark-graphite);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 300px 1fr;
                gap: 1.5rem;
            }
            
            .map-container {
                height: 500px;
            }
        }

        @media (max-width: 992px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--white);
                flex-direction: column;
                padding: 2rem;
                box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            }
            
            .nav-menu.active {
                display: flex;
            }
            
            .nav-item.active::after {
                display: none;
            }
            
            .mobile-menu-btn {
                display: flex;
            }
            
            .main-content {
                padding: 1rem;
                margin-top: 90px;
            }
            
            .logo img {
                transform: scale(2.2);
                margin-left: 10px;
            }
            
            .map-container {
                height: 400px;
            }
            
            .profile-dropdown {
                position: fixed;
                top: 100px;
                left: 1rem;
                right: 1rem;
                width: auto;
            }
        }

        @media (max-width: 576px) {
            .nav-container {
                padding: 0 1rem;
            }
            
            .main-content {
                padding: 0.5rem;
            }
            
            .map-container {
                height: 350px;
                border-radius: 15px;
            }
            
            .map-controls {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .gps-status {
                width: 100%;
                justify-content: space-between;
            }
            
            .location-btn {
                align-self: flex-end;
                margin-top: -60px;
            }
            
            .status-card {
                padding: 1.5rem;
            }
            
            .status-selector {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .logo img {
                transform: scale(1.8);
                margin-left: 5px;
            }
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner-large {
            width: 70px;
            height: 70px;
            border: 5px solid rgba(255, 196, 0, 0.2);
            border-radius: 50%;
            border-top-color: var(--taxi-yellow);
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.3rem;
            color: var(--dark-graphite);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--light-gray);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid rgba(0,0,0,0.1);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn-modal {
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-modal.primary {
            background: var(--taxi-yellow);
            color: var(--dark-graphite);
        }

        .btn-modal.primary:hover {
            background: #ffb100;
        }

        .btn-modal.secondary {
            background: var(--light-gray);
            color: var(--dark-graphite);
        }

        .btn-modal.secondary:hover {
            background: #e8e8e8;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo">
                <img src="logotaxibf.png" alt="TaxiBF Logo">
            </a>
            
            <div class="nav-menu" id="navMenu">
                <a href="#" class="nav-item active">
                    <i class="fas fa-dashboard"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" id="navHistory">
                    <i class="fas fa-history"></i>
                    <span>Hist√≥rico</span>
                </a>
                <a href="#" class="nav-item" id="navRatings">
                    <i class="fas fa-star"></i>
                    <span>Avalia√ß√µes</span>
                </a>
                <a href="#" class="nav-item" id="navSettings">
                    <i class="fas fa-cog"></i>
                    <span>Configura√ß√µes</span>
                </a>
            </div>

            <div class="user-menu">
                <div class="user-profile-menu">
                    <div class="user-avatar" id="userAvatar">
                        <span id="userInitials">--</span>
                    </div>
                    <div class="profile-dropdown" id="profileDropdown">
                        <div class="dropdown-header">
                            <div class="dropdown-user-info">
                                <div class="dropdown-avatar" id="dropdownAvatar">
                                    <span id="dropdownInitials">--</span>
                                </div>
                                <div class="dropdown-user-details">
                                    <h4 id="dropdownName">Carregando...</h4>
                                    <p id="dropdownEmail">carregando...</p>
                                </div>
                            </div>
                        </div>
                        <div class="dropdown-menu">
                            <a href="perfil-taxista.html" class="dropdown-item">
                                <i class="fas fa-user-circle"></i>
                                <span>Ver Perfil Completo</span>
                            </a>
                            <a href="editar-perfil-taxista.html" class="dropdown-item">
                                <i class="fas fa-user-edit"></i>
                                <span>Editar Perfil</span>
                            </a>
                            <a href="documentos-taxista.html" class="dropdown-item">
                                <i class="fas fa-file-alt"></i>
                                <span>Meus Documentos</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="configuracoes-taxista.html" class="dropdown-item">
                                <i class="fas fa-cog"></i>
                                <span>Configura√ß√µes</span>
                            </a>
                            <a href="ajuda-taxista.html" class="dropdown-item">
                                <i class="fas fa-question-circle"></i>
                                <span>Ajuda & Suporte</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <div class="dropdown-item" id="dropdownLogout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Sair</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn-logout" id="btnLogout" title="Sair">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="dashboard-grid">
            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Alerts -->
                <div class="alert-card" id="alertCard">
                    <i class="fas fa-exclamation-triangle alert-icon"></i>
                    <div class="alert-content">
                        <h4 id="alertTitle">Carregando</h4>
                        <p id="alertMessage">Verificando dados do sistema...</p>
                    </div>
                </div>

                <!-- Status Card -->
                <div class="status-card">
                    <div class="status-header">
                        <h3 class="status-title">Meu Status</h3>
                        <div class="verified-badge" id="verificationBadge">
                            <i class="fas fa-circle-notch fa-spin"></i>
                            CARREGANDO
                        </div>
                    </div>
                    
                    <div class="status-selector">
                        <button class="status-btn available" data-status="available" id="btnAvailable">
                            <i class="fas fa-check-circle status-icon"></i>
                            Dispon√≠vel
                        </button>
                        <button class="status-btn busy" data-status="busy" id="btnBusy">
                            <i class="fas fa-user-clock status-icon"></i>
                            Ocupado
                        </button>
                        <button class="status-btn offline" data-status="offline" id="btnOffline">
                            <i class="fas fa-moon status-icon"></i>
                            Ausente
                        </button>
                    </div>
                    
                    <div class="credentials">
                        <div class="credential-item">
                            <span class="credential-label">
                                <i class="fas fa-id-card"></i>
                                Alvar√°
                            </span>
                            <span class="credential-value loading" id="alvaraNumber">--</span>
                        </div>
                        <div class="credential-item">
                            <span class="credential-label">
                                <i class="fas fa-car"></i>
                                Placa
                            </span>
                            <span class="credential-value loading" id="placaVeiculo">--</span>
                        </div>
                        <div class="credential-item">
                            <span class="credential-label">
                                <i class="fas fa-taxi"></i>
                                Tipo
                            </span>
                            <span class="credential-value loading" id="tipoVeiculo">--</span>
                        </div>
                        <div class="credential-item">
                            <span class="credential-label">
                                <i class="fas fa-map-marker-alt"></i>
                                Bairro
                            </span>
                            <span class="credential-value loading" id="bairroAtuacao">--</span>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value loading" id="corridasHoje">--</div>
                            <div class="stat-label">Corridas Hoje</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value loading" id="avaliacaoMedia">--</div>
                            <div class="stat-label">Avalia√ß√£o</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value loading" id="faturamentoHoje">--</div>
                            <div class="stat-label">Faturamento Hoje</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value loading" id="tempoOnline">--</div>
                            <div class="stat-label">Tempo Online</div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="status-card">
                    <h3 class="status-title" style="margin-bottom: 1.5rem;">A√ß√µes R√°pidas</h3>
                    
                    <div class="quick-actions">
                        <button class="action-btn" id="btnEditProfile">
                            <i class="fas fa-user-edit"></i>
                            <span>Editar Perfil</span>
                        </button>
                        <button class="action-btn" id="btnNotifications">
                            <i class="fas fa-bell"></i>
                            <span>Notifica√ß√µes</span>
                        </button>
                        <button class="action-btn" id="btnDocuments">
                            <i class="fas fa-file-alt"></i>
                            <span>Documentos</span>
                        </button>
                        <button class="action-btn" id="btnHelp">
                            <i class="fas fa-question-circle"></i>
                            <span>Ajuda</span>
                        </button>
                    </div>
                </div>

                <!-- Subscription -->
                <div class="subscription-card no-subscription" id="subscriptionCard">
                    <div class="subscription-header">
                        <h3 class="subscription-title">Minha Assinatura</h3>
                        <span class="subscription-status" id="subscriptionStatus">--</span>
                    </div>
                    
                    <p class="subscription-details" id="subscriptionDetails">
                        Carregando informa√ß√µes da assinatura...
                    </p>
                    
                    <button class="btn-subscription loading" id="btnSubscription" disabled>
                        <i class="fas fa-circle-notch fa-spin"></i> CARREGANDO...
                    </button>
                </div>
            </div>

            <!-- Map Section -->
            <div class="map-section">
                <div class="map-container">
                    <div class="map-controls">
                        <div class="gps-status inactive" id="gpsStatus">
                            <i class="fas fa-circle-notch fa-spin"></i>
                            <span>Verificando GPS...</span>
                            <small>Conectando com o sistema</small>
                        </div>
                        <button class="location-btn" id="btnLocation" title="Atualizar localiza√ß√£o" disabled>
                            <i class="fas fa-crosshairs"></i>
                        </button>
                    </div>
                    
                    <div class="map-placeholder">
                        <i class="fas fa-circle-notch fa-spin"></i>
                        <p id="mapTitle">Carregando mapa...</p>
                        <small id="mapSubtitle">Aguardando dados do sistema</small>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner-large"></div>
        <p id="loadingMessage">Inicializando sistema...</p>
    </div>

    <!-- Modal de Status -->
    <div class="modal" id="statusModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Alterar Status</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modalMessage">Tem certeza que deseja alterar seu status?</p>
                <div class="form-group">
                    <label for="statusNote">Observa√ß√£o (opcional):</label>
                    <textarea id="statusNote" class="form-control" rows="3" placeholder="Ex: Pausa para almo√ßo, combust√≠vel, etc."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal secondary" id="modalCancel">Cancelar</button>
                <button class="btn-modal primary" id="modalConfirm">Confirmar</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration (substitua com suas credenciais)
        const firebaseConfig = {
            apiKey: "SUA_API_KEY_AQUI",
            authDomain: "SEU_PROJETO.firebaseapp.com",
            projectId: "SEU_PROJETO",
            storageBucket: "SEU_PROJETO.appspot.com",
            messagingSenderId: "SEU_SENDER_ID",
            appId: "SEU_APP_ID"
        };

        // Inicialize o Firebase quando estiver pronto
        // firebase.initializeApp(firebaseConfig);
        // const auth = firebase.auth();
        // const db = firebase.firestore();

        // Elementos DOM
        const loadingOverlay = document.getElementById('loadingOverlay');
        const loadingMessage = document.getElementById('loadingMessage');
        const userAvatar = document.getElementById('userAvatar');
        const userInitials = document.getElementById('userInitials');
        const profileDropdown = document.getElementById('profileDropdown');
        const dropdownAvatar = document.getElementById('dropdownAvatar');
        const dropdownInitials = document.getElementById('dropdownInitials');
        const dropdownName = document.getElementById('dropdownName');
        const dropdownEmail = document.getElementById('dropdownEmail');
        const dropdownLogout = document.getElementById('dropdownLogout');
        const btnLogout = document.getElementById('btnLogout');
        const gpsStatus = document.getElementById('gpsStatus');
        const btnLocation = document.getElementById('btnLocation');
        const statusModal = document.getElementById('statusModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const statusNote = document.getElementById('statusNote');
        const modalClose = document.getElementById('modalClose');
        const modalCancel = document.getElementById('modalCancel');
        const modalConfirm = document.getElementById('modalConfirm');
        const mapTitle = document.getElementById('mapTitle');
        const mapSubtitle = document.getElementById('mapSubtitle');
        const alertCard = document.getElementById('alertCard');
        const alertTitle = document.getElementById('alertTitle');
        const alertMessage = document.getElementById('alertMessage');

        // Dados do perfil
        const alvaraNumber = document.getElementById('alvaraNumber');
        const placaVeiculo = document.getElementById('placaVeiculo');
        const tipoVeiculo = document.getElementById('tipoVeiculo');
        const bairroAtuacao = document.getElementById('bairroAtuacao');
        const verificationBadge = document.getElementById('verificationBadge');
        const corridasHoje = document.getElementById('corridasHoje');
        const avaliacaoMedia = document.getElementById('avaliacaoMedia');
        const faturamentoHoje = document.getElementById('faturamentoHoje');
        const tempoOnline = document.getElementById('tempoOnline');

        // Status buttons
        const btnAvailable = document.getElementById('btnAvailable');
        const btnBusy = document.getElementById('btnBusy');
        const btnOffline = document.getElementById('btnOffline');

        // Subscription
        const subscriptionCard = document.getElementById('subscriptionCard');
        const subscriptionStatus = document.getElementById('subscriptionStatus');
        const subscriptionDetails = document.getElementById('subscriptionDetails');
        const btnSubscription = document.getElementById('btnSubscription');

        // Bot√µes de a√ß√£o
        const btnEditProfile = document.getElementById('btnEditProfile');
        const btnNotifications = document.getElementById('btnNotifications');
        const btnDocuments = document.getElementById('btnDocuments');
        const btnHelp = document.getElementById('btnHelp');

        // Estado
        let currentUser = null;
        let taxistaData = null;
        let currentStatus = 'offline';
        let statusChangePending = null;
        let onlineStartTime = null;
        let onlineTimer = null;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            loadingMessage.textContent = "Conectando ao sistema...";
            loadingOverlay.classList.add('active');
            
            setupEventListeners();
            initializeFirebase();
        });

        function setupEventListeners() {
            // Menu do usu√°rio
            userAvatar.addEventListener('click', toggleProfileDropdown);
            
            // Fechar dropdown
            document.addEventListener('click', function(event) {
                if (!userAvatar.contains(event.target) && !profileDropdown.contains(event.target)) {
                    profileDropdown.classList.remove('active');
                }
            });
            
            // Logout
            dropdownLogout.addEventListener('click', logout);
            btnLogout.addEventListener('click', logout);
            
            // Status buttons
            btnAvailable.addEventListener('click', () => requestStatusChange('available'));
            btnBusy.addEventListener('click', () => requestStatusChange('busy'));
            btnOffline.addEventListener('click', () => requestStatusChange('offline'));
            
            // Modal
            modalClose.addEventListener('click', closeModal);
            modalCancel.addEventListener('click', closeModal);
            modalConfirm.addEventListener('click', confirmStatusChange);
            
            // Bot√µes de a√ß√£o
            btnEditProfile.addEventListener('click', () => window.location.href = 'editar-perfil-taxista.html');
            btnNotifications.addEventListener('click', () => window.location.href = 'notificacoes-taxista.html');
            btnDocuments.addEventListener('click', () => window.location.href = 'documentos-taxista.html');
            btnHelp.addEventListener('click', () => window.location.href = 'ajuda-taxista.html');
            btnSubscription.addEventListener('click', handleSubscription);
            btnLocation.addEventListener('click', updateLocation);
            
            // Mobile menu
            document.getElementById('mobileMenuBtn').addEventListener('click', function() {
                document.getElementById('navMenu').classList.toggle('active');
            });
            
            // Navega√ß√£o
            document.getElementById('navHistory').addEventListener('click', (e) => {
                e.preventDefault();
                window.location.href = 'historico-taxista.html';
            });
            document.getElementById('navRatings').addEventListener('click', (e) => {
                e.preventDefault();
                window.location.href = 'avaliacoes-taxista.html';
            });
            document.getElementById('navSettings').addEventListener('click', (e) => {
                e.preventDefault();
                window.location.href = 'configuracoes-taxista.html';
            });
        }

        function initializeFirebase() {
            // Verificar se Firebase est√° configurado
            setTimeout(() => {
                if (typeof firebase === 'undefined') {
                    showError('Firebase n√£o configurado. Configure suas credenciais.');
                    return;
                }
                
                try {
                    // firebase.initializeApp(firebaseConfig);
                    checkAuth();
                } catch (error) {
                    showError('Erro ao inicializar Firebase: ' + error.message);
                }
            }, 1000);
        }

        function checkAuth() {
            loadingMessage.textContent = "Verificando autentica√ß√£o...";
            
            // Simula√ß√£o de autentica√ß√£o - REMOVI DADOS FICT√çCIOS
            setTimeout(() => {
                // Verifica√ß√£o real do Firebase Auth
                // auth.onAuthStateChanged(async (user) => {
                //     if (user) {
                //         currentUser = user;
                //         await loadTaxistaData();
                //     } else {
                //         redirectToLogin();
                //     }
                // });
                
                // Por enquanto, apenas mostra estado de carregamento
                showLoadingState();
                checkGPS();
                
                // Simular falha de conex√£o para mostrar estado real
                setTimeout(() => {
                    showError('N√£o conectado ao Firebase. Configure as credenciais.');
                }, 3000);
                
            }, 1500);
        }

        async function loadTaxistaData() {
            try {
                loadingMessage.textContent = "Carregando dados do taxista...";
                
                if (!currentUser) {
                    throw new Error('Usu√°rio n√£o autenticado');
                }
                
                // üî• BUSCAR DADOS REAIS DO FIRESTORE - SEM DADOS FICT√çCIOS
                // const userDoc = await db.collection('taxistas').doc(currentUser.uid).get();
                
                // if (!userDoc.exists) {
                //     throw new Error('Perfil de taxista n√£o encontrado');
                // }
                
                // taxistaData = userDoc.data();
                
                // Atualizar UI com dados REAIS
                // updateUIWithRealData();
                
                // Por enquanto, apenas mostrar estado de carregamento
                showLoadingState();
                
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                showError('Erro ao carregar dados: ' + error.message);
            }
        }

        function updateUIWithRealData() {
            if (!taxistaData) {
                showError('Dados do taxista n√£o dispon√≠veis');
                return;
            }
            
            // Remover estado de loading
            removeLoadingState();
            
            // Atualizar com dados REAIS do Firestore
            updateBasicInfo();
            updateCredentials();
            updateStats();
            updateVerificationStatus();
            updateSubscription();
            updateStatusUI();
            checkAlerts();
        }

        function updateBasicInfo() {
            // Dados REAIS do Firestore
            const nome = taxistaData.nome || '';
            const email = taxistaData.email || '';
            
            // Iniciais REAIS
            const initials = getInitials(nome);
            userInitials.textContent = initials;
            dropdownInitials.textContent = initials;
            dropdownName.textContent = nome;
            dropdownEmail.textContent = email;
            
            // Avatar verificada
            if (taxistaData.statusVerificacao === 'verificado') {
                userAvatar.classList.add('verified');
            } else {
                userAvatar.classList.remove('verified');
            }
        }

        function updateCredentials() {
            // Dados REAIS do Firestore
            alvaraNumber.textContent = taxistaData.alvara || 'N√£o informado';
            placaVeiculo.textContent = taxistaData.placa || 'N√£o informado';
            tipoVeiculo.textContent = taxistaData.tipoVeiculo || 'N√£o informado';
            bairroAtuacao.textContent = taxistaData.bairroAtuacao || 'N√£o informado';
            
            // Remover anima√ß√£o de loading
            alvaraNumber.classList.remove('loading');
            placaVeiculo.classList.remove('loading');
            tipoVeiculo.classList.remove('loading');
            bairroAtuacao.classList.remove('loading');
        }

        function updateStats() {
            // Dados REAIS do Firestore
            corridasHoje.textContent = taxistaData.corridasHoje || 0;
            avaliacaoMedia.textContent = taxistaData.avaliacaoMedia ? taxistaData.avaliacaoMedia.toFixed(1) : '0.0';
            faturamentoHoje.textContent = taxistaData.faturamentoHoje ? `R$ ${taxistaData.faturamentoHoje.toFixed(2)}` : 'R$ 0,00';
            tempoOnline.textContent = taxistaData.tempoOnlineHoje ? `${taxistaData.tempoOnlineHoje.toFixed(1)}h` : '0h';
            
            // Remover anima√ß√£o de loading
            corridasHoje.classList.remove('loading');
            avaliacaoMedia.classList.remove('loading');
            faturamentoHoje.classList.remove('loading');
            tempoOnline.classList.remove('loading');
        }

        function updateVerificationStatus() {
            const status = taxistaData.statusVerificacao || 'pendente';
            
            verificationBadge.innerHTML = '';
            
            switch(status) {
                case 'verificado':
                    verificationBadge.className = 'verified-badge';
                    verificationBadge.innerHTML = '<i class="fas fa-shield-alt"></i> VERIFICADO';
                    break;
                case 'pendente':
                    verificationBadge.className = 'pending-badge';
                    verificationBadge.innerHTML = '<i class="fas fa-clock"></i> PENDENTE';
                    break;
                case 'rejeitado':
                    verificationBadge.className = 'expired-badge';
                    verificationBadge.innerHTML = '<i class="fas fa-exclamation-circle"></i> REJEITADO';
                    break;
                default:
                    verificationBadge.className = 'verified-badge';
                    verificationBadge.innerHTML = '<i class="fas fa-question-circle"></i> DESCONHECIDO';
            }
        }

        function updateSubscription() {
            const assinatura = taxistaData.assinatura;
            
            if (!assinatura || assinatura.status === 'nenhuma') {
                subscriptionCard.className = 'subscription-card no-subscription';
                subscriptionStatus.textContent = 'NENHUMA';
                subscriptionDetails.textContent = 'Voc√™ ainda n√£o possui uma assinatura ativa';
                btnSubscription.innerHTML = '<i class="fas fa-plus-circle"></i> ASSINAR AGORA';
                btnSubscription.className = 'btn-subscription primary';
            } else {
                subscriptionCard.className = 'subscription-card';
                subscriptionStatus.textContent = assinatura.status.toUpperCase();
                subscriptionStatus.className = `subscription-status ${assinatura.status}`;
                
                // Datas REAIS
                if (assinatura.dataExpiracao) {
                    const expiracao = new Date(assinatura.dataExpiracao);
                    const hoje = new Date();
                    const diffTime = expiracao - hoje;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    subscriptionDetails.textContent = `Plano ${assinatura.tipo} ‚Ä¢ Expira em: ${expiracao.toLocaleDateString('pt-BR')}`;
                    
                    if (assinatura.status === 'ativa') {
                        btnSubscription.innerHTML = '<i class="fas fa-sync-alt"></i> GERENCIAR ASSINATURA';
                        btnSubscription.className = 'btn-subscription';
                    } else if (assinatura.status === 'pendente') {
                        btnSubscription.innerHTML = '<i class="fas fa-clock"></i> AGUARDANDO PAGAMENTO';
                        btnSubscription.className = 'btn-subscription';
                    } else if (assinatura.status === 'expirada') {
                        btnSubscription.innerHTML = '<i class="fas fa-exclamation-triangle"></i> RENOVAR ASSINATURA';
                        btnSubscription.className = 'btn-subscription primary';
                    }
                }
            }
            
            btnSubscription.disabled = false;
            btnSubscription.classList.remove('loading');
        }

        function updateStatusUI(status = null) {
            const newStatus = status || taxistaData?.status || 'offline';
            currentStatus = newStatus;
            
            // Atualizar bot√µes
            btnAvailable.classList.remove('active');
            btnBusy.classList.remove('active');
            btnOffline.classList.remove('active');
            
            // Atualizar mapa
            switch(newStatus) {
                case 'available':
                    btnAvailable.classList.add('active');
                    mapTitle.textContent = 'Mapa de Atua√ß√£o';
                    mapSubtitle.textContent = 'Voc√™ est√° vis√≠vel para passageiros';
                    startOnlineTimer();
                    break;
                case 'busy':
                    btnBusy.classList.add('active');
                    mapTitle.textContent = 'Status: Ocupado';
                    mapSubtitle.textContent = 'Finalize a corrida para voltar ao mapa';
                    stopOnlineTimer();
                    break;
                case 'offline':
                    btnOffline.classList.add('active');
                    mapTitle.textContent = 'Status: Ausente';
                    mapSubtitle.textContent = 'Voc√™ est√° offline no momento';
                    stopOnlineTimer();
                    break;
            }
            
            // Habilitar bot√£o de localiza√ß√£o se dispon√≠vel
            btnLocation.disabled = newStatus !== 'available';
        }

        function showLoadingState() {
            // Manter todos os campos em estado de carregamento
            alertTitle.textContent = 'Carregando';
            alertMessage.textContent = 'Conectando com o banco de dados...';
            alertCard.style.display = 'flex';
            
            // Estado inicial - tudo carregando
            updateStatusUI('offline');
            
            // Desabilitar intera√ß√µes
            btnAvailable.disabled = true;
            btnBusy.disabled = true;
            btnOffline.disabled = true;
            btnSubscription.disabled = true;
            btnLocation.disabled = true;
        }

        function removeLoadingState() {
            // Habilitar intera√ß√µes
            btnAvailable.disabled = false;
            btnBusy.disabled = false;
            btnOffline.disabled = false;
            btnSubscription.disabled = false;
            
            // Esconder loading overlay
            loadingOverlay.classList.remove('active');
        }

        function showError(message) {
            loadingMessage.textContent = message;
            
            // Mostrar alerta
            alertTitle.textContent = 'Erro de Conex√£o';
            alertMessage.textContent = message;
            alertCard.style.display = 'flex';
            alertCard.style.background = 'rgba(231, 76, 60, 0.1)';
            alertCard.style.borderColor = 'var(--busy)';
            
            // Desabilitar funcionalidades
            btnAvailable.disabled = true;
            btnBusy.disabled = true;
            btnOffline.disabled = true;
            btnSubscription.disabled = true;
            btnLocation.disabled = true;
            
            // Mostrar estado offline
            updateStatusUI('offline');
        }

        function getInitials(name) {
            if (!name || typeof name !== 'string') return '??';
            return name.split(' ')
                .map(part => part[0])
                .join('')
                .toUpperCase()
                .substring(0, 2);
        }

        function requestStatusChange(newStatus) {
            if (newStatus === currentStatus) return;
            
            statusChangePending = newStatus;
            
            const statusText = getStatusText(newStatus);
            modalTitle.textContent = `Alterar para ${statusText}`;
            modalMessage.textContent = `Tem certeza que deseja alterar seu status para ${statusText}?`;
            statusNote.value = '';
            
            statusModal.classList.add('active');
        }

        function confirmStatusChange() {
            if (!statusChangePending) return;
            
            const note = statusNote.value.trim();
            const newStatus = statusChangePending;
            
            // Atualizar no Firestore (dados REAIS)
            updateStatusInFirestore(newStatus, note);
            
            // Atualizar UI local
            updateStatusUI(newStatus);
            
            closeModal();
            showNotification(`Status alterado para ${getStatusText(newStatus)}`);
        }

        async function updateStatusInFirestore(status, note = '') {
            if (!currentUser || !taxistaData) return;
            
            try {
                // Atualiza√ß√£o REAL no Firestore
                // await db.collection('taxistas').doc(currentUser.uid).update({
                //     status: status,
                //     ultimaAtualizacao: new Date().toISOString()
                // });
                
                // Registrar no hist√≥rico se houver observa√ß√£o
                if (note) {
                    // await db.collection('historicos_status').add({
                    //     taxistaId: currentUser.uid,
                    //     statusAnterior: currentStatus,
                    //     statusNovo: status,
                    //     observacao: note,
                    //     timestamp: new Date().toISOString()
                    // });
                }
                
                console.log(`Status atualizado para: ${status}`);
                
            } catch (error) {
                console.error('Erro ao atualizar status:', error);
                showNotification('Erro ao atualizar status. Tente novamente.');
            }
        }

        function getStatusText(status) {
            const textos = {
                'available': 'Dispon√≠vel',
                'busy': 'Ocupado',
                'offline': 'Ausente'
            };
            return textos[status] || 'Desconhecido';
        }

        function closeModal() {
            statusModal.classList.remove('active');
            statusChangePending = null;
            statusNote.value = '';
        }

        function handleSubscription() {
            if (!taxistaData || !taxistaData.assinatura) {
                window.location.href = 'assinatura-taxista.html?action=new';
            } else {
                const status = taxistaData.assinatura.status;
                if (status === 'nenhuma' || status === 'expirada') {
                    window.location.href = 'assinatura-taxista.html?action=new';
                } else {
                    window.location.href = 'assinatura-taxista.html?action=manage';
                }
            }
        }

        function checkGPS() {
            if (!navigator.geolocation) {
                gpsActive = false;
                updateGPSDisplay();
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    gpsActive = true;
                    updateGPSDisplay();
                    btnLocation.disabled = false;
                    
                    // Atualizar localiza√ß√£o no Firestore se estiver dispon√≠vel
                    if (currentStatus === 'available' && currentUser) {
                        updateLocationInFirestore(position.coords);
                    }
                },
                (error) => {
                    gpsActive = false;
                    updateGPSDisplay();
                    console.warn('GPS n√£o autorizado:', error.message);
                }
            );
        }

        function updateGPSDisplay() {
            if (gpsActive) {
                gpsStatus.innerHTML = `
                    <i class="fas fa-satellite"></i>
                    <span>GPS: Ativo</span>
                    <small>Localiza√ß√£o dispon√≠vel</small>
                `;
                gpsStatus.className = 'gps-status active';
            } else {
                gpsStatus.innerHTML = `
                    <i class="fas fa-satellite"></i>
                    <span>GPS: Inativo</span>
                    <small>Permiss√£o necess√°ria</small>
                `;
                gpsStatus.className = 'gps-status inactive';
            }
        }

        function updateLocation() {
            loadingMessage.textContent = "Atualizando localiza√ß√£o...";
            loadingOverlay.classList.add('active');
            
            if (!navigator.geolocation) {
                loadingOverlay.classList.remove('active');
                alert('Seu navegador n√£o suporta geolocaliza√ß√£o.');
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    gpsActive = true;
                    updateGPSDisplay();
                    
                    // Atualizar no Firestore (dados REAIS)
                    if (currentUser) {
                        await updateLocationInFirestore(position.coords);
                    }
                    
                    loadingOverlay.classList.remove('active');
                    showNotification('Localiza√ß√£o atualizada!');
                },
                (error) => {
                    gpsActive = false;
                    updateGPSDisplay();
                    loadingOverlay.classList.remove('active');
                    alert('Permiss√£o de localiza√ß√£o negada. Ative nas configura√ß√µes do navegador.');
                },
                { enableHighAccuracy: true, timeout: 10000 }
            );
        }

        async function updateLocationInFirestore(coords) {
            if (!currentUser) return;
            
            try {
                // Atualiza√ß√£o REAL no Firestore
                // await db.collection('taxistas').doc(currentUser.uid).update({
                //     ultimaLocalizacao: {
                //         lat: coords.latitude,
                //         lng: coords.longitude,
                //         timestamp: new Date().toISOString()
                //     },
                //     ultimaAtualizacaoGPS: new Date().toISOString()
                // });
                
                console.log('Localiza√ß√£o atualizada no Firestore');
                
            } catch (error) {
                console.error('Erro ao atualizar localiza√ß√£o:', error);
            }
        }

        function startOnlineTimer() {
            stopOnlineTimer();
            onlineStartTime = new Date();
            
            onlineTimer = setInterval(() => {
                if (onlineStartTime) {
                    const now = new Date();
                    const diffMs = now - onlineStartTime;
                    const diffHours = diffMs / (1000 * 60 * 60);
                    
                    if (taxistaData) {
                        tempoOnline.textContent = `${diffHours.toFixed(1)}h`;
                    }
                }
            }, 60000);
        }

        function stopOnlineTimer() {
            if (onlineTimer) {
                clearInterval(onlineTimer);
                onlineTimer = null;
            }
        }

        function checkAlerts() {
            if (!taxistaData) return;
            
            const alerts = [];
            
            // Verifica√ß√µes com dados REAIS
            if (taxistaData.statusVerificacao === 'pendente') {
                alerts.push({
                    title: 'Documentos Pendentes',
                    message: 'Seus documentos est√£o em an√°lise. Aguarde a aprova√ß√£o.',
                    type: 'warning'
                });
            }
            
            if (taxistaData.assinatura?.status === 'expirada') {
                alerts.push({
                    title: 'Assinatura Expirada',
                    message: 'Sua assinatura expirou. Renove para continuar trabalhando.',
                    type: 'error'
                });
            }
            
            if (taxistaData.avaliacaoMedia < 3.5) {
                alerts.push({
                    title: 'Avalia√ß√£o Baixa',
                    message: 'Sua avalia√ß√£o est√° abaixo da m√©dia. Verifique suas corridas.',
                    type: 'warning'
                });
            }
            
            if (alerts.length > 0) {
                const alert = alerts[0];
                alertTitle.textContent = alert.title;
                alertMessage.textContent = alert.message;
                alertCard.style.display = 'flex';
            } else {
                alertCard.style.display = 'none';
            }
        }

        function showNotification(message) {
            // Implementa√ß√£o de notifica√ß√£o
            console.log('Notifica√ß√£o:', message);
            alert(message); // Simples por enquanto
        }

        function toggleProfileDropdown() {
            profileDropdown.classList.toggle('active');
        }

        function logout() {
            if (confirm('Tem certeza que deseja sair?')) {
                loadingMessage.textContent = "Saindo da conta...";
                loadingOverlay.classList.add('active');
                
                // Logout REAL do Firebase
                // auth.signOut().then(() => {
                //     redirectToLogin();
                // }).catch(error => {
                //     console.error('Erro ao sair:', error);
                //     redirectToLogin();
                // });
                
                setTimeout(() => {
                    window.location.href = 'login-taxista.html';
                }, 1000);
            }
        }

        function redirectToLogin() {
            window.location.href = 'login-taxista.html';
        }

        // Adicionar anima√ß√£o de pulso
        const style = document.createElement('style');
        style.textContent = `
            .fa-spin {
                animation: fa-spin 2s infinite linear;
            }
            @keyframes fa-spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>