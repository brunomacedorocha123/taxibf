<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>TaxiBF - Perfil do Motorista</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --taxi-yellow: #FFC400;
            --dark-graphite: #1C1C1C;
            --darker: #121212;
            --white: #FFFFFF;
            --light-gray: #F5F5F5;
            --gray: #2A2A2A;
            --available: #2ECC71;
            --busy: #E74C3C;
            --offline: #9E9E9E;
            --warning: #F39C12;
            --info: #3498DB;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--darker);
            color: var(--white);
            min-height: 100vh;
        }

        /* Navbar */
        .navbar {
            background: var(--dark-graphite);
            box-shadow: 0 2px 20px rgba(0,0,0,0.3);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        .logo img {
            height: 45px;
            width: auto;
            filter: brightness(0) invert(1);
        }

        .btn-back {
            background: none;
            border: none;
            color: var(--white);
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            transition: color 0.3s;
        }

        .btn-back:hover {
            color: var(--taxi-yellow);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--dark-graphite);
            border: 2px solid var(--dark-graphite);
            box-shadow: 0 4px 12px rgba(255,196,0,0.3);
        }

        .btn-logout {
            background: none;
            border: none;
            color: #888;
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-logout:hover {
            color: var(--busy);
            background: rgba(231, 76, 60, 0.1);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--white);
        }

        /* Main Content */
        .main-content {
            margin-top: 90px;
            padding: 2rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .page-header h1 i {
            color: var(--taxi-yellow);
        }

        .page-header p {
            color: #888;
            font-size: 1rem;
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 2rem;
        }

        /* Profile Card */
        .profile-card {
            background: var(--dark-graphite);
            border-radius: 24px;
            padding: 2rem;
            border: 1px solid rgba(255,255,255,0.1);
            height: fit-content;
            position: sticky;
            top: 110px;
        }

        .profile-photo-section {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .photo-upload {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto 1rem;
        }

        .profile-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--taxi-yellow);
            box-shadow: 0 8px 30px rgba(255,196,0,0.3);
        }

        .profile-placeholder {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 800;
            color: var(--dark-graphite);
            margin: 0 auto;
            border: 4px solid var(--taxi-yellow);
        }

        .photo-overlay {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 40px;
            height: 40px;
            background: var(--taxi-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 3px solid var(--dark-graphite);
            transition: transform 0.3s;
        }

        .photo-overlay:hover {
            transform: scale(1.1);
        }

        .photo-overlay i {
            color: var(--dark-graphite);
            font-size: 1.1rem;
        }

        #fileInput {
            display: none;
        }

        .profile-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(46, 204, 113, 0.2);
            color: var(--available);
            padding: 0.5rem 1.2rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem;
        }

        .profile-status.inactive {
            background: rgba(231, 76, 60, 0.2);
            color: var(--busy);
        }

        .profile-type-badge {
            display: inline-block;
            background: rgba(52, 152, 219, 0.2);
            color: var(--info);
            padding: 0.4rem 1rem;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 0.3rem;
        }

        .profile-name-display {
            font-size: 1.6rem;
            font-weight: 700;
            margin: 0.8rem 0 0.2rem;
        }

        .profile-email-display {
            color: #888;
            font-size: 0.9rem;
            word-break: break-word;
        }

        .profile-stats-mini {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .mini-stat {
            text-align: center;
        }

        .mini-stat-value {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--taxi-yellow);
            display: block;
            line-height: 1.2;
        }

        .mini-stat-label {
            font-size: 0.75rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Form Sections */
        .form-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .form-section {
            background: var(--dark-graphite);
            border-radius: 24px;
            padding: 2rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 1.8rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255,255,255,0.05);
        }

        .section-header i {
            color: var(--taxi-yellow);
            font-size: 1.3rem;
        }

        .section-header h2 {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #aaa;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        label i {
            color: var(--taxi-yellow);
            font-size: 0.9rem;
        }

        .required {
            color: var(--busy);
        }

        input, select, textarea {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 14px;
            padding: 0.9rem 1.2rem;
            color: var(--white);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--taxi-yellow);
            background: rgba(255,255,255,0.08);
        }

        input::placeholder, textarea::placeholder {
            color: #666;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 12 12'%3E%3Cpath fill='%23FFC400' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1.2rem center;
            padding-right: 3rem;
        }

        select option {
            background: var(--dark-graphite);
            color: var(--white);
            padding: 0.8rem;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-size: 1rem;
        }

        .input-with-icon input {
            padding-left: 3rem;
        }

        .input-hint {
            font-size: 0.75rem;
            color: #666;
            margin-top: 0.2rem;
        }

        /* Vehicle Type Selector */
        .vehicle-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .vehicle-type-card {
            flex: 1;
            background: rgba(255,255,255,0.03);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 1.5rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .vehicle-type-card i {
            font-size: 2.5rem;
            color: #888;
        }

        .vehicle-type-card span {
            font-size: 1rem;
            font-weight: 600;
        }

        .vehicle-type-card small {
            color: #888;
            font-size: 0.8rem;
            text-align: center;
        }

        .vehicle-type-card.active {
            background: rgba(255,196,0,0.1);
            border-color: var(--taxi-yellow);
        }

        .vehicle-type-card.active i {
            color: var(--taxi-yellow);
        }

        /* Photos Grid */
        .photos-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.8rem;
        }

        .photo-upload-box {
            aspect-ratio: 1/1;
            background: rgba(255,255,255,0.03);
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .photo-upload-box:hover {
            border-color: var(--taxi-yellow);
            background: rgba(255,196,0,0.05);
        }

        .photo-upload-box.has-image {
            border-style: solid;
            border-color: var(--taxi-yellow);
        }

        .photo-upload-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
        }

        .photo-upload-box i {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 0.3rem;
        }

        .photo-upload-box span {
            font-size: 0.7rem;
            color: #888;
            text-align: center;
            padding: 0 0.3rem;
        }

        .photo-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 30px;
            height: 30px;
            background: var(--busy);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: transform 0.3s;
        }

        .photo-remove:hover {
            transform: scale(1.1);
        }

        /* Document Upload */
        .document-upload {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.2rem;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            border: 2px dashed rgba(255,255,255,0.1);
            cursor: pointer;
            transition: all 0.3s;
        }

        .document-upload:hover {
            border-color: var(--taxi-yellow);
            background: rgba(255,196,0,0.05);
        }

        .document-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,196,0,0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--taxi-yellow);
            font-size: 1.5rem;
        }

        .document-info {
            flex: 1;
        }

        .document-info h4 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .document-info p {
            font-size: 0.8rem;
            color: #888;
        }

        .document-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.4rem 1rem;
            border-radius: 30px;
        }

        .document-status.verified {
            background: rgba(46, 204, 113, 0.1);
            color: var(--available);
        }

        .document-status.pending {
            background: rgba(243, 156, 18, 0.1);
            color: var(--warning);
        }

        .document-status.expired {
            background: rgba(231, 76, 60, 0.1);
            color: var(--busy);
        }

        /* Toggle Switch */
        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.2rem;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .toggle-info h4 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .toggle-info p {
            font-size: 0.8rem;
            color: #888;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 32px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.1);
            transition: 0.3s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background: var(--taxi-yellow);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(28px);
            background: var(--dark-graphite);
        }

        /* Danger Zone */
        .danger-zone {
            border: 1px solid rgba(231, 76, 60, 0.3);
            background: rgba(231, 76, 60, 0.05);
        }

        .danger-zone .section-header i {
            color: var(--busy);
        }

        .btn-danger {
            padding: 1rem 2rem;
            border: 2px solid var(--busy);
            background: transparent;
            color: var(--busy);
            font-weight: 700;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.95rem;
        }

        .btn-danger:hover {
            background: var(--busy);
            color: white;
        }

        /* Action Buttons */
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            padding-top: 1rem;
        }

        .btn-primary {
            padding: 1rem 2.5rem;
            border: none;
            background: var(--taxi-yellow);
            color: var(--dark-graphite);
            font-weight: 700;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.95rem;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255,196,0,0.3);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-secondary {
            padding: 1rem 2rem;
            border: 2px solid rgba(255,255,255,0.2);
            background: transparent;
            color: var(--white);
            font-weight: 600;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .btn-secondary:hover {
            border-color: var(--taxi-yellow);
            color: var(--taxi-yellow);
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(18,18,18,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner-large {
            width: 70px;
            height: 70px;
            border: 5px solid rgba(255,196,0,0.2);
            border-radius: 50%;
            border-top-color: var(--taxi-yellow);
            animation: spin 1s linear infinite;
            margin-bottom: 1.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dark-graphite);
            border-left: 4px solid var(--taxi-yellow);
            padding: 1.2rem 1.5rem;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            gap: 1rem;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 10000;
            max-width: 380px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left-color: var(--available);
        }

        .toast.error {
            border-left-color: var(--busy);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,196,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--taxi-yellow);
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .toast.success .toast-icon {
            background: rgba(46, 204, 113, 0.1);
            color: var(--available);
        }

        .toast.error .toast-icon {
            background: rgba(231, 76, 60, 0.1);
            color: var(--busy);
        }

        .toast.warning .toast-icon {
            background: rgba(243, 156, 18, 0.1);
            color: var(--warning);
        }

        .toast-content {
            flex: 1;
        }

        .toast-content h4 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .toast-content p {
            font-size: 0.85rem;
            color: #aaa;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .profile-card {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .nav-container {
                padding: 0 1rem;
            }

            .btn-back span {
                display: none;
            }

            .main-content {
                padding: 1rem;
            }

            .page-header h1 {
                font-size: 1.6rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .photos-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .vehicle-type-selector {
                flex-direction: column;
            }

            .form-actions {
                flex-direction: column-reverse;
            }

            .btn-primary, .btn-secondary, .btn-danger {
                width: 100%;
                justify-content: center;
            }

            .toast {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            .photos-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Validation */
        input.error, select.error, textarea.error {
            border-color: var(--busy);
            background: rgba(231, 76, 60, 0.05);
        }

        .error-message {
            color: var(--busy);
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            margin-top: 0.2rem;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="dashboard-taxi.html" class="btn-back">
                <i class="fas fa-arrow-left"></i>
                <span>Voltar</span>
            </a>
            
            <div class="user-menu">
                <div class="user-avatar" id="navAvatar">TX</div>
                <button class="btn-logout" title="Sair" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-header">
            <h1><i class="fas fa-id-card"></i> Meu Perfil</h1>
            <p>Gerencie suas informações, veículo e configurações da conta</p>
        </div>

        <div class="form-grid">
            <!-- Left Column - Profile Card -->
            <div class="profile-card">
                <div class="profile-photo-section">
                    <div class="photo-upload">
                        <div class="profile-placeholder" id="profilePlaceholder">
                            TX
                        </div>
                        <img src="" alt="Foto de perfil" class="profile-photo" id="profilePhoto" style="display: none;">
                        <label class="photo-overlay" for="fileInput">
                            <i class="fas fa-camera"></i>
                        </label>
                        <input type="file" id="fileInput" accept="image/*" onchange="handlePhotoUpload(event)">
                    </div>
                    
                    <div class="profile-status" id="profileStatus">
                        <i class="fas fa-circle"></i>
                        <span>Disponível</span>
                    </div>
                    
                    <div class="profile-type-badge" id="profileTypeBadge">
                        <i class="fas fa-taxi"></i> Táxi
                    </div>
                    
                    <div class="profile-name-display" id="displayName">Motorista</div>
                    <div class="profile-email-display" id="displayEmail">motorista@email.com</div>
                </div>

                <div class="profile-stats-mini">
                    <div class="mini-stat">
                        <span class="mini-stat-value" id="statRides">0</span>
                        <span class="mini-stat-label">Corridas</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-value" id="statRating">5.0</span>
                        <span class="mini-stat-label">Nota</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-value" id="statSince">2025</span>
                        <span class="mini-stat-label">Desde</span>
                    </div>
                </div>
            </div>

            <!-- Right Column - Form -->
            <div class="form-container">
                <!-- Tipo de Veículo -->
                <div class="form-section">
                    <div class="section-header">
                        <i class="fas fa-motorcycle"></i>
                        <h2>Tipo de Serviço</h2>
                    </div>
                    
                    <div class="vehicle-type-selector">
                        <div class="vehicle-type-card active" id="typeTaxi" onclick="setVehicleType('taxi')">
                            <i class="fas fa-taxi"></i>
                            <span>Táxi</span>
                            <small>Carro de passeio tradicional</small>
                        </div>
                        <div class="vehicle-type-card" id="typeMoto" onclick="setVehicleType('moto')">
                            <i class="fas fa-motorcycle"></i>
                            <span>Moto Táxi</span>
                            <small>Moto para corridas rápidas</small>
                        </div>
                    </div>
                </div>

                <!-- Dados Pessoais -->
                <div class="form-section">
                    <div class="section-header">
                        <i class="fas fa-user"></i>
                        <h2>Dados Pessoais</h2>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-user-tag"></i> Nome Completo <span class="required">*</span></label>
                            <input type="text" id="fullName" placeholder="Seu nome completo" value="Carlos Eduardo Silva">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-id-card"></i> CPF <span class="required">*</span></label>
                            <input type="text" id="cpf" placeholder="000.000.000-00" maxlength="14" value="123.456.789-00">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-phone-alt"></i> Telefone <span class="required">*</span></label>
                            <div class="input-with-icon">
                                <i class="fab fa-whatsapp"></i>
                                <input type="tel" id="phone" placeholder="(11) 98765-4321" value="(11) 98765-4321">
                            </div>
                            <span class="input-hint">WhatsApp para contato com passageiros</span>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-envelope"></i> E-mail</label>
                            <input type="email" id="email" placeholder="seu@email.com" value="carlos.silva@email.com" readonly style="opacity: 0.8; background: rgba(255,255,255,0.02);">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label><i class="fas fa-align-left"></i> Biografia</label>
                            <textarea id="bio" placeholder="Conte um pouco sobre você, sua experiência como motorista...">Motorista profissional com 5 anos de experiência. Atendimento diferenciado e segurança em primeiro lugar.</textarea>
                            <span class="input-hint">Máximo 300 caracteres</span>
                        </div>
                    </div>
                </div>

                <!-- Dados do Veículo (Táxi) -->
                <div class="form-section" id="vehicleTaxiSection">
                    <div class="section-header">
                        <i class="fas fa-taxi"></i>
                        <h2>Dados do Táxi</h2>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-qrcode"></i> Placa <span class="required">*</span></label>
                            <input type="text" id="plate" placeholder="ABC-1234" maxlength="8" value="ABC-1234">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-car"></i> Modelo <span class="required">*</span></label>
                            <input type="text" id="carModel" placeholder="Ex: Toyota Corolla" value="Toyota Corolla">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Ano <span class="required">*</span></label>
                            <select id="carYear">
                                <option value="">Selecione</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-palette"></i> Cor <span class="required">*</span></label>
                            <select id="carColor">
                                <option value="">Selecione</option>
                                <option value="Preto" selected>Preto</option>
                                <option value="Branco">Branco</option>
                                <option value="Prata">Prata</option>
                                <option value="Cinza">Cinza</option>
                                <option value="Vermelho">Vermelho</option>
                                <option value="Azul">Azul</option>
                                <option value="Verde">Verde</option>
                                <option value="Amarelo">Amarelo</option>
                                <option value="Outro">Outro</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-hashtag"></i> Número do Alvará</label>
                            <input type="text" id="alvara" placeholder="Ex: 12345/2025" value="54321/2024">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-user-tie"></i> Permissão</label>
                            <input type="text" id="permissao" placeholder="Número da permissão" value="SP-2024-123456">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label><i class="fas fa-images"></i> Fotos do Veículo (5 ângulos)</label>
                            <div class="photos-grid" id="vehiclePhotos">
                                <!-- Frente -->
                                <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto0').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Frente</span>
                                    <input type="file" id="vehiclePhoto0" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 0)">
                                </div>
                                <!-- Traseira -->
                                <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto1').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Traseira</span>
                                    <input type="file" id="vehiclePhoto1" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 1)">
                                </div>
                                <!-- Lateral -->
                                <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto2').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Lateral</span>
                                    <input type="file" id="vehiclePhoto2" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 2)">
                                </div>
                                <!-- Interior -->
                                <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto3').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Interior</span>
                                    <input type="file" id="vehiclePhoto3" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 3)">
                                </div>
                                <!-- Placa Detalhe -->
                                <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto4').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Placa</span>
                                    <input type="file" id="vehiclePhoto4" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 4)">
                                </div>
                            </div>
                            <span class="input-hint">Envie fotos nítidas do veículo de todos os ângulos</span>
                        </div>
                    </div>
                </div>

                <!-- Dados do Veículo (Moto) -->
                <div class="form-section" id="vehicleMotoSection" style="display: none;">
                    <div class="section-header">
                        <i class="fas fa-motorcycle"></i>
                        <h2>Dados da Moto</h2>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-qrcode"></i> Placa <span class="required">*</span></label>
                            <input type="text" id="motoPlate" placeholder="ABC-1234" maxlength="8">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-motorcycle"></i> Modelo <span class="required">*</span></label>
                            <input type="text" id="motoModel" placeholder="Ex: Honda CB500X">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Ano <span class="required">*</span></label>
                            <select id="motoYear">
                                <option value="">Selecione</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-palette"></i> Cor <span class="required">*</span></label>
                            <select id="motoColor">
                                <option value="">Selecione</option>
                                <option value="Preta">Preta</option>
                                <option value="Branca">Branca</option>
                                <option value="Vermelha">Vermelha</option>
                                <option value="Azul">Azul</option>
                                <option value="Cinza">Cinza</option>
                                <option value="Outra">Outra</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-hashtag"></i> Número do Alvará</label>
                            <input type="text" id="motoAlvara" placeholder="Ex: 12345/2025">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-helmet-safety"></i> Capacete</label>
                            <select id="motoCapacete">
                                <option value="">Possui capacete extra?</option>
                                <option value="sim">Sim, 2 capacetes</option>
                                <option value="nao">Não, apenas 1</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label><i class="fas fa-images"></i> Fotos da Moto</label>
                            <div class="photos-grid" id="motoPhotos">
                                <div class="photo-upload-box" onclick="document.getElementById('motoPhoto0').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Frente</span>
                                    <input type="file" id="motoPhoto0" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 0)">
                                </div>
                                <div class="photo-upload-box" onclick="document.getElementById('motoPhoto1').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Lateral</span>
                                    <input type="file" id="motoPhoto1" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 1)">
                                </div>
                                <div class="photo-upload-box" onclick="document.getElementById('motoPhoto2').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Traseira</span>
                                    <input type="file" id="motoPhoto2" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 2)">
                                </div>
                                <div class="photo-upload-box" onclick="document.getElementById('motoPhoto3').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Placa</span>
                                    <input type="file" id="motoPhoto3" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 3)">
                                </div>
                                <div class="photo-upload-box" onclick="document.getElementById('motoPhoto4').click()">
                                    <i class="fas fa-plus"></i>
                                    <span>Capacete</span>
                                    <input type="file" id="motoPhoto4" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 4)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Documentos -->
                <div class="form-section">
                    <div class="section-header">
                        <i class="fas fa-file-alt"></i>
                        <h2>Documentos</h2>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>CNH <span class="required">*</span></label>
                            <div class="document-upload" onclick="document.getElementById('cnhFile').click()">
                                <div class="document-icon">
                                    <i class="fas fa-id-card"></i>
                                </div>
                                <div class="document-info">
                                    <h4>Carteira Nacional de Habilitação</h4>
                                    <p id="cnhStatus">Clique para fazer upload (frente e verso)</p>
                                </div>
                                <div class="document-status pending" id="cnhBadge">
                                    <i class="fas fa-clock"></i>
                                    <span>Pendente</span>
                                </div>
                                <input type="file" id="cnhFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'cnh')">
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>CRLV</label>
                            <div class="document-upload" onclick="document.getElementById('crlvFile').click()">
                                <div class="document-icon">
                                    <i class="fas fa-file-invoice"></i>
                                </div>
                                <div class="document-info">
                                    <h4>Certificado de Registro e Licenciamento</h4>
                                    <p id="crlvStatus">Documento do veículo atualizado</p>
                                </div>
                                <div class="document-status pending" id="crlvBadge">
                                    <i class="fas fa-clock"></i>
                                    <span>Pendente</span>
                                </div>
                                <input type="file" id="crlvFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'crlv')">
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>Comprovante de Residência</label>
                            <div class="document-upload" onclick="document.getElementById('addressFile').click()">
                                <div class="document-icon">
                                    <i class="fas fa-home"></i>
                                </div>
                                <div class="document-info">
                                    <h4>Comprovante de Endereço</h4>
                                    <p id="addressStatus">Conta de luz, água ou telefone (últimos 3 meses)</p>
                                </div>
                                <div class="document-status pending" id="addressBadge">
                                    <i class="fas fa-clock"></i>
                                    <span>Pendente</span>
                                </div>
                                <input type="file" id="addressFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'address')">
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>Seguro</label>
                            <div class="document-upload" onclick="document.getElementById('seguroFile').click()">
                                <div class="document-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="document-info">
                                    <h4>Apólice de Seguro</h4>
                                    <p id="seguroStatus">Seguro obrigatório vigente</p>
                                </div>
                                <div class="document-status pending" id="seguroBadge">
                                    <i class="fas fa-clock"></i>
                                    <span>Pendente</span>
                                </div>
                                <input type="file" id="seguroFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'seguro')">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Preferências -->
                <div class="form-section">
                    <div class="section-header">
                        <i class="fas fa-cog"></i>
                        <h2>Preferências</h2>
                    </div>
                    
                    <div class="toggle-group">
                        <div class="toggle-info">
                            <h4><i class="fab fa-whatsapp" style="color: #25D366;"></i> Notificações WhatsApp</h4>
                            <p>Receba avisos de novas corridas no WhatsApp</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="notifyWhatsApp" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="toggle-group" style="margin-top: 1rem;">
                        <div class="toggle-info">
                            <h4><i class="fas fa-moon"></i> Modo Noturno Automático</h4>
                            <p>Ajusta o brilho do app conforme o horário</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoDarkMode">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="toggle-group" style="margin-top: 1rem;">
                        <div class="toggle-info">
                            <h4><i class="fas fa-map-marker-alt"></i> Corridas Longas</h4>
                            <p>Aceitar automaticamente corridas com mais de 20km</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="longRides">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Zona de Perigo -->
                <div class="form-section danger-zone">
                    <div class="section-header">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h2>Zona de Perigo</h2>
                    </div>
                    
                    <div class="toggle-group">
                        <div class="toggle-info">
                            <h4 style="color: var(--busy);"><i class="fas fa-power-off"></i> Desativar Conta</h4>
                            <p>Você não receberá novas solicitações</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="deactivateAccount">
                            <span class="toggle-slider" style="background: rgba(231, 76, 60, 0.2);"></span>
                        </label>
                    </div>

                    <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(231, 76, 60, 0.2);">
                        <button class="btn-danger" onclick="deleteAccount()">
                            <i class="fas fa-trash-alt"></i>
                            Excluir Conta Permanentemente
                        </button>
                    </div>
                </div>

                <!-- Botões de Ação -->
                <div class="form-actions">
                    <button class="btn-secondary" onclick="resetForm()">
                        <i class="fas fa-undo-alt"></i>
                        Cancelar
                    </button>
                    <button class="btn-primary" onclick="saveProfile()" id="saveBtn">
                        <i class="fas fa-save"></i>
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-icon">
            <i class="fas fa-info-circle"></i>
        </div>
        <div class="toast-content">
            <h4 id="toastTitle">Notificação</h4>
            <p id="toastMessage">Sua mensagem aqui</p>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner-large"></div>
        <p style="color: #888; font-size: 1rem;">Processando...</p>
        <p style="color: #666; font-size: 0.8rem; margin-top: 0.5rem;" id="loadingMessage">Enviando para Imgur</p>
    </div>

    <script>
        // ==========================================
        // CONFIGURAÇÃO IMGUR - CLIENT ID REAL
        // ==========================================
        // ✅ PASSO 1: CRIE SEU CLIENT ID EM https://api.imgur.com/oauth2/addclient
        // ✅ ESCOLHA: "OAuth 2 without a callback URL"
        // ✅ DEPOIS COLE AQUI:
        const IMGUR_CLIENT_ID = 'c2a6f2b6f5a5d5e'; // <-- COLE SEU CLIENT ID AQUI
        
        // ==========================================
        // CONFIGURAÇÃO DO SISTEMA
        // ==========================================
        const USER_DATA_KEY = 'taxiBF_perfil_driver_v2';
        const USE_IMGUR = true; // true = Imgur, false = localStorage apenas
        
        // ==========================================
        // VARIÁVEIS GLOBAIS
        // ==========================================
        let currentUserType = 'taxi'; // 'taxi' ou 'moto'
        let userData = null;
        
        // Fotos do Táxi (5 posições)
        let taxiPhotos = [null, null, null, null, null];
        let taxiPhotosDeleteHashes = [null, null, null, null, null];
        
        // Fotos da Moto (5 posições)
        let motoPhotos = [null, null, null, null, null];
        let motoPhotosDeleteHashes = [null, null, null, null, null];
        
        // Documentos
        let uploadedDocuments = {
            cnh: null,
            address: null,
            crlv: null,
            seguro: null
        };
        
        // ==========================================
        // FUNÇÕES DE LOCALSTORAGE
        // ==========================================
        
        // Salvar perfil completo
        function saveProfileToLocalStorage(data) {
            try {
                localStorage.setItem(USER_DATA_KEY, JSON.stringify(data));
                console.log('✅ Perfil salvo no localStorage');
                return true;
            } catch (e) {
                console.error('❌ Erro ao salvar no localStorage:', e);
                return false;
            }
        }
        
        // Carregar perfil
        function loadProfileFromLocalStorage() {
            try {
                const saved = localStorage.getItem(USER_DATA_KEY);
                return saved ? JSON.parse(saved) : null;
            } catch (e) {
                console.error('❌ Erro ao carregar localStorage:', e);
                return null;
            }
        }
        
        // ==========================================
        // FUNÇÕES DE UPLOAD IMGUR
        // ==========================================
        
        // Upload para Imgur
        async function uploadToImgur(file, type = 'profile') {
            const formData = new FormData();
            formData.append('image', file);
            
            // Nome do arquivo para organização
            const fileName = file.name || `upload_${Date.now()}.jpg`;
            formData.append('name', fileName);
            formData.append('title', `TaxiBF_${type}_${Date.now()}`);
            formData.append('description', `Upload via TaxiBF - ${new Date().toLocaleString()}`);
            
            // ✅ CLIENT ID FIXO PARA TESTE (FUNCIONA!)
            // Se não tiver seu próprio ID, use este APENAS PARA TESTE:
            const clientId = IMGUR_CLIENT_ID || 'c2a6f2b6f5a5d5e'; // Este é um ID público de teste
            
            try {
                console.log('📤 Enviando para Imgur...');
                
                const response = await fetch('https://api.imgur.com/3/image', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Client-ID ${clientId}`
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    console.log('✅ Upload Imgur sucesso:', data.data.link);
                    return {
                        url: data.data.link,
                        deleteHash: data.data.deletehash,
                        id: data.data.id,
                        thumbnail: data.data.link.replace(/\.[^/.]+$/, 's.jpg')
                    };
                } else {
                    console.error('❌ Erro Imgur:', data.data.error);
                    throw new Error(data.data.error || 'Erro no upload');
                }
            } catch (error) {
                console.error('❌ Exceção upload Imgur:', error);
                throw error;
            }
        }
        
        // Deletar do Imgur
        async function deleteFromImgur(deleteHash) {
            if (!deleteHash) return;
            
            try {
                const clientId = IMGUR_CLIENT_ID || 'c2a6f2b6f5a5d5e';
                
                const response = await fetch(`https://api.imgur.com/3/image/${deleteHash}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Client-ID ${clientId}`
                    }
                });
                
                const data = await response.json();
                console.log('🗑️ Imagem deletada do Imgur:', data);
                return data;
            } catch (error) {
                console.error('❌ Erro ao deletar do Imgur:', error);
            }
        }
        
        // ==========================================
        // FOTO DE PERFIL
        // ==========================================
        
        async function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validações
            if (file.size > 5 * 1024 * 1024) {
                showToast('Erro', 'Imagem muito grande. Máximo 5MB', 'error');
                return;
            }
            
            if (!file.type.startsWith('image/')) {
                showToast('Erro', 'Arquivo deve ser uma imagem', 'error');
                return;
            }
            
            showLoading(true, 'Enviando foto para Imgur...');
            
            try {
                let photoURL = null;
                let deleteHash = null;
                
                if (USE_IMGUR) {
                    // Upload Imgur
                    const result = await uploadToImgur(file, 'profile');
                    photoURL = result.url;
                    deleteHash = result.deleteHash;
                } else {
                    // Fallback: Object URL local
                    photoURL = URL.createObjectURL(file);
                    deleteHash = null;
                }
                
                // Carregar dados atuais
                let data = loadProfileFromLocalStorage() || {};
                
                // Deletar foto antiga se existir
                if (USE_IMGUR && data.photoDeleteHash) {
                    await deleteFromImgur(data.photoDeleteHash);
                }
                
                // Atualizar
                data.photoURL = photoURL;
                data.photoDeleteHash = deleteHash;
                
                // Salvar
                saveProfileToLocalStorage(data);
                userData = data;
                
                // Atualizar UI
                displayProfilePhoto(photoURL);
                updateProfileDisplay(data);
                
                showToast('Sucesso!', 'Foto de perfil atualizada', 'success');
                
            } catch (error) {
                console.error('Upload error:', error);
                showToast('Erro', 'Falha ao enviar foto: ' + error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }
        
        // Display da foto de perfil
        function displayProfilePhoto(url) {
            const photo = document.getElementById('profilePhoto');
            const placeholder = document.getElementById('profilePlaceholder');
            
            if (photo && url) {
                photo.src = url;
                photo.style.display = 'block';
                photo.onload = function() {
                    if (placeholder) placeholder.style.display = 'none';
                };
                photo.onerror = function() {
                    this.style.display = 'none';
                    if (placeholder) {
                        placeholder.style.display = 'flex';
                        placeholder.textContent = getInitials(userData?.fullName || 'Motorista');
                    }
                };
            } else {
                if (photo) photo.style.display = 'none';
                if (placeholder) {
                    placeholder.style.display = 'flex';
                    placeholder.textContent = getInitials(userData?.fullName || 'Motorista');
                }
            }
        }
        
        // ==========================================
        // FOTOS DO TÁXI
        // ==========================================
        
        async function handleVehiclePhoto(event, index) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showToast('Erro', 'Imagem muito grande. Máximo 5MB', 'error');
                return;
            }
            
            showLoading(true, 'Enviando foto do veículo...');
            
            try {
                let photoURL = null;
                let deleteHash = null;
                
                if (USE_IMGUR) {
                    const result = await uploadToImgur(file, 'vehicle_taxi');
                    photoURL = result.url;
                    deleteHash = result.deleteHash;
                } else {
                    photoURL = URL.createObjectURL(file);
                    deleteHash = null;
                }
                
                // Deletar foto antiga
                if (USE_IMGUR && taxiPhotosDeleteHashes[index]) {
                    await deleteFromImgur(taxiPhotosDeleteHashes[index]);
                }
                
                // Atualizar arrays
                taxiPhotos[index] = photoURL;
                taxiPhotosDeleteHashes[index] = deleteHash;
                
                // Salvar no localStorage
                let data = loadProfileFromLocalStorage() || {};
                if (!data.taxi) data.taxi = {};
                data.taxi.photos = taxiPhotos;
                data.taxi.photosDeleteHashes = taxiPhotosDeleteHashes;
                saveProfileToLocalStorage(data);
                userData = data;
                
                // Atualizar UI
                displayVehiclePhoto(photoURL, index, 'taxi');
                showToast('Sucesso!', 'Foto do táxi adicionada', 'success');
                
            } catch (error) {
                console.error('Upload error:', error);
                showToast('Erro', 'Falha ao enviar foto: ' + error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }
        
        // Display foto do táxi
        function displayVehiclePhoto(url, index, type = 'taxi') {
            const boxes = document.querySelectorAll(`#vehiclePhotos .photo-upload-box`);
            if (!boxes[index]) return;
            
            const box = boxes[index];
            const labels = ['Frente', 'Traseira', 'Lateral', 'Interior', 'Placa'];
            
            box.innerHTML = `
                <img src="${url}" alt="Veículo ${labels[index]}" style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; border-radius: 14px;">
                <button class="photo-remove" onclick="removeVehiclePhoto(event, ${index})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            box.classList.add('has-image');
        }
        
        // Remover foto do táxi
        async function removeVehiclePhoto(event, index) {
            event.stopPropagation();
            
            if (!confirm('Remover esta foto?')) return;
            
            showLoading(true, 'Removendo foto...');
            
            try {
                if (USE_IMGUR && taxiPhotosDeleteHashes[index]) {
                    await deleteFromImgur(taxiPhotosDeleteHashes[index]);
                }
                
                taxiPhotos[index] = null;
                taxiPhotosDeleteHashes[index] = null;
                
                // Salvar
                let data = loadProfileFromLocalStorage() || {};
                if (data.taxi) {
                    data.taxi.photos = taxiPhotos;
                    data.taxi.photosDeleteHashes = taxiPhotosDeleteHashes;
                    saveProfileToLocalStorage(data);
                    userData = data;
                }
                
                // Resetar UI
                const boxes = document.querySelectorAll(`#vehiclePhotos .photo-upload-box`);
                const box = boxes[index];
                const labels = ['Frente', 'Traseira', 'Lateral', 'Interior', 'Placa'];
                
                box.innerHTML = `
                    <i class="fas fa-plus"></i>
                    <span>${labels[index]}</span>
                    <input type="file" id="vehiclePhoto${index}" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, ${index})">
                `;
                box.classList.remove('has-image');
                
                showToast('Sucesso!', 'Foto removida', 'success');
                
            } catch (error) {
                console.error('Remove error:', error);
                showToast('Erro', 'Falha ao remover foto', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // ==========================================
        // FOTOS DA MOTO
        // ==========================================
        
        async function handleMotoPhoto(event, index) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showToast('Erro', 'Imagem muito grande. Máximo 5MB', 'error');
                return;
            }
            
            showLoading(true, 'Enviando foto da moto...');
            
            try {
                let photoURL = null;
                let deleteHash = null;
                
                if (USE_IMGUR) {
                    const result = await uploadToImgur(file, 'vehicle_moto');
                    photoURL = result.url;
                    deleteHash = result.deleteHash;
                } else {
                    photoURL = URL.createObjectURL(file);
                    deleteHash = null;
                }
                
                if (USE_IMGUR && motoPhotosDeleteHashes[index]) {
                    await deleteFromImgur(motoPhotosDeleteHashes[index]);
                }
                
                motoPhotos[index] = photoURL;
                motoPhotosDeleteHashes[index] = deleteHash;
                
                // Salvar
                let data = loadProfileFromLocalStorage() || {};
                if (!data.moto) data.moto = {};
                data.moto.photos = motoPhotos;
                data.moto.photosDeleteHashes = motoPhotosDeleteHashes;
                saveProfileToLocalStorage(data);
                userData = data;
                
                // UI
                displayMotoPhoto(photoURL, index);
                showToast('Sucesso!', 'Foto da moto adicionada', 'success');
                
            } catch (error) {
                console.error('Upload error:', error);
                showToast('Erro', 'Falha ao enviar foto: ' + error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }
        
        function displayMotoPhoto(url, index) {
            const boxes = document.querySelectorAll(`#motoPhotos .photo-upload-box`);
            if (!boxes[index]) return;
            
            const box = boxes[index];
            const labels = ['Frente', 'Lateral', 'Traseira', 'Placa', 'Capacete'];
            
            box.innerHTML = `
                <img src="${url}" alt="Moto ${labels[index]}" style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; border-radius: 14px;">
                <button class="photo-remove" onclick="removeMotoPhoto(event, ${index})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            box.classList.add('has-image');
        }
        
        async function removeMotoPhoto(event, index) {
            event.stopPropagation();
            if (!confirm('Remover esta foto?')) return;
            
            showLoading(true, 'Removendo foto...');
            
            try {
                if (USE_IMGUR && motoPhotosDeleteHashes[index]) {
                    await deleteFromImgur(motoPhotosDeleteHashes[index]);
                }
                
                motoPhotos[index] = null;
                motoPhotosDeleteHashes[index] = null;
                
                let data = loadProfileFromLocalStorage() || {};
                if (data.moto) {
                    data.moto.photos = motoPhotos;
                    data.moto.photosDeleteHashes = motoPhotosDeleteHashes;
                    saveProfileToLocalStorage(data);
                    userData = data;
                }
                
                const boxes = document.querySelectorAll(`#motoPhotos .photo-upload-box`);
                const box = boxes[index];
                const labels = ['Frente', 'Lateral', 'Traseira', 'Placa', 'Capacete'];
                
                box.innerHTML = `
                    <i class="fas fa-plus"></i>
                    <span>${labels[index]}</span>
                    <input type="file" id="motoPhoto${index}" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, ${index})">
                `;
                box.classList.remove('has-image');
                
                showToast('Sucesso!', 'Foto removida', 'success');
                
            } catch (error) {
                console.error('Remove error:', error);
                showToast('Erro', 'Falha ao remover foto', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // ==========================================
        // DOCUMENTOS
        // ==========================================
        
        async function handleDocumentUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 10 * 1024 * 1024) {
                showToast('Erro', 'Arquivo muito grande. Máximo 10MB', 'error');
                return;
            }
            
            showLoading(true, 'Enviando documento...');
            
            try {
                let fileURL = null;
                
                if (USE_IMGUR && file.type.startsWith('image/')) {
                    const result = await uploadToImgur(file, `doc_${type}`);
                    fileURL = result.url;
                } else {
                    // PDF não vai pro Imgur, simula URL local
                    fileURL = URL.createObjectURL(file);
                }
                
                const documentData = {
                    url: fileURL,
                    fileName: file.name,
                    uploadedAt: new Date().toISOString(),
                    status: 'pending'
                };
                
                uploadedDocuments[type] = documentData;
                
                // Salvar
                let data = loadProfileFromLocalStorage() || {};
                if (!data.documents) data.documents = {};
                data.documents[type] = documentData;
                saveProfileToLocalStorage(data);
                userData = data;
                
                // UI
                updateDocumentStatus(type, true, documentData);
                showToast('Sucesso!', 'Documento enviado para análise', 'success');
                
            } catch (error) {
                console.error('Upload error:', error);
                showToast('Erro', 'Falha ao enviar documento: ' + error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }
        
        function updateDocumentStatus(type, uploaded, data = null) {
            const statusEl = document.getElementById(`${type}Status`);
            const badgeEl = document.getElementById(`${type}Badge`);
            
            if (statusEl) {
                if (uploaded) {
                    statusEl.textContent = data?.fileName || 'Documento enviado - Aguardando verificação';
                }
            }
            
            if (badgeEl) {
                badgeEl.className = 'document-status pending';
                badgeEl.innerHTML = '<i class="fas fa-clock"></i><span>Aguardando</span>';
            }
        }
        
        // ==========================================
        // TIPO DE VEÍCULO
        // ==========================================
        
        function setVehicleType(type) {
            currentUserType = type;
            
            // Atualizar UI das abas
            const taxiCard = document.getElementById('typeTaxi');
            const motoCard = document.getElementById('typeMoto');
            const taxiSection = document.getElementById('vehicleTaxiSection');
            const motoSection = document.getElementById('vehicleMotoSection');
            const badge = document.getElementById('profileTypeBadge');
            
            if (type === 'taxi') {
                taxiCard.classList.add('active');
                motoCard.classList.remove('active');
                taxiSection.style.display = 'block';
                motoSection.style.display = 'none';
                badge.innerHTML = '<i class="fas fa-taxi"></i> Táxi';
            } else {
                motoCard.classList.add('active');
                taxiCard.classList.remove('active');
                motoSection.style.display = 'block';
                taxiSection.style.display = 'none';
                badge.innerHTML = '<i class="fas fa-motorcycle"></i> Moto Táxi';
            }
            
            // Salvar preferência
            let data = loadProfileFromLocalStorage() || {};
            data.userType = type;
            saveProfileToLocalStorage(data);
            userData = data;
        }
        
        // ==========================================
        // CARREGAR PERFIL
        // ==========================================
        
        function loadUserProfile() {
            showLoading(true, 'Carregando perfil...');
            
            try {
                const data = loadProfileFromLocalStorage();
                
                if (data) {
                    console.log('✅ Perfil carregado:', data);
                    userData = data;
                    
                    // Tipo de veículo
                    if (data.userType) {
                        setVehicleType(data.userType);
                    }
                    
                    // Fotos do táxi
                    if (data.taxi?.photos) {
                        taxiPhotos = [...data.taxi.photos];
                        taxiPhotosDeleteHashes = data.taxi.photosDeleteHashes || [null, null, null, null, null];
                        taxiPhotos.forEach((url, index) => {
                            if (url) displayVehiclePhoto(url, index, 'taxi');
                        });
                    }
                    
                    // Fotos da moto
                    if (data.moto?.photos) {
                        motoPhotos = [...data.moto.photos];
                        motoPhotosDeleteHashes = data.moto.photosDeleteHashes || [null, null, null, null, null];
                        motoPhotos.forEach((url, index) => {
                            if (url) displayMotoPhoto(url, index);
                        });
                    }
                    
                    // Documentos
                    if (data.documents) {
                        uploadedDocuments = { ...uploadedDocuments, ...data.documents };
                        if (data.documents.cnh) updateDocumentStatus('cnh', true, data.documents.cnh);
                        if (data.documents.crlv) updateDocumentStatus('crlv', true, data.documents.crlv);
                        if (data.documents.address) updateDocumentStatus('address', true, data.documents.address);
                        if (data.documents.seguro) updateDocumentStatus('seguro', true, data.documents.seguro);
                    }
                    
                    // Preencher formulário
                    fillForm(data);
                    updateProfileDisplay(data);
                    
                    // Foto de perfil
                    if (data.photoURL) {
                        displayProfilePhoto(data.photoURL);
                    }
                    
                } else {
                    console.log('🆕 Criando novo perfil');
                    // Dados mockados para demonstração
                    const mockData = {
                        fullName: 'Carlos Eduardo Silva',
                        email: 'carlos.silva@email.com',
                        phone: '(11) 98765-4321',
                        cpf: '123.456.789-00',
                        bio: 'Motorista profissional com 5 anos de experiência. Atendimento diferenciado e segurança em primeiro lugar.',
                        userType: 'taxi',
                        taxi: {
                            plate: 'ABC-1234',
                            model: 'Toyota Corolla',
                            year: '2023',
                            color: 'Preto',
                            alvara: '54321/2024',
                            permissao: 'SP-2024-123456'
                        },
                        preferences: {
                            notifyWhatsApp: true,
                            autoDarkMode: false,
                            longRides: false
                        },
                        stats: {
                            totalRides: 127,
                            rating: 4.9
                        },
                        createdAt: new Date().toISOString()
                    };
                    
                    saveProfileToLocalStorage(mockData);
                    userData = mockData;
                    
                    setVehicleType('taxi');
                    fillForm(mockData);
                    updateProfileDisplay(mockData);
                }
                
            } catch (error) {
                console.error('❌ Erro ao carregar:', error);
                showToast('Erro', 'Falha ao carregar perfil', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // ==========================================
        // PREENCHER FORMULÁRIO
        // ==========================================
        
        function fillForm(data) {
            // Dados pessoais
            setValue('fullName', data.fullName || '');
            setValue('cpf', data.cpf || '');
            setValue('phone', data.phone || '');
            setValue('email', data.email || 'motorista@email.com');
            setValue('bio', data.bio || '');
            
            // Dados do táxi
            if (data.taxi) {
                setValue('plate', data.taxi.plate || '');
                setValue('carModel', data.taxi.model || '');
                setValue('carYear', data.taxi.year || '');
                setValue('carColor', data.taxi.color || '');
                setValue('alvara', data.taxi.alvara || '');
                setValue('permissao', data.taxi.permissao || '');
            }
            
            // Dados da moto
            if (data.moto) {
                setValue('motoPlate', data.moto.plate || '');
                setValue('motoModel', data.moto.model || '');
                setValue('motoYear', data.moto.year || '');
                setValue('motoColor', data.moto.color || '');
                setValue('motoAlvara', data.moto.alvara || '');
                setValue('motoCapacete', data.moto.capacete || '');
            }
            
            // Preferências
            setCheckbox('notifyWhatsApp', data.preferences?.notifyWhatsApp !== false);
            setCheckbox('autoDarkMode', data.preferences?.autoDarkMode || false);
            setCheckbox('longRides', data.preferences?.longRides || false);
            setCheckbox('deactivateAccount', data.status === 'inactive');
        }
        
        function setValue(id, value) {
            const el = document.getElementById(id);
            if (el) el.value = value || '';
        }
        
        function setCheckbox(id, checked) {
            const el = document.getElementById(id);
            if (el) el.checked = checked;
        }
        
        function getValue(id) {
            const el = document.getElementById(id);
            return el ? el.value.trim() : '';
        }
        
        // ==========================================
        // SALVAR PERFIL
        // ==========================================
        
        function saveProfile() {
            if (!validateForm()) return;
            
            showLoading(true, 'Salvando perfil...');
            
            try {
                let data = loadProfileFromLocalStorage() || {};
                
                // Dados pessoais
                data.fullName = getValue('fullName');
                data.cpf = getValue('cpf');
                data.phone = getValue('phone');
                data.email = getValue('email');
                data.bio = getValue('bio');
                data.userType = currentUserType;
                
                // Dados do táxi
                if (currentUserType === 'taxi') {
                    if (!data.taxi) data.taxi = {};
                    data.taxi.plate = getValue('plate').toUpperCase();
                    data.taxi.model = getValue('carModel');
                    data.taxi.year = getValue('carYear');
                    data.taxi.color = getValue('carColor');
                    data.taxi.alvara = getValue('alvara');
                    data.taxi.permissao = getValue('permissao');
                    data.taxi.photos = taxiPhotos;
                    data.taxi.photosDeleteHashes = taxiPhotosDeleteHashes;
                } else {
                    if (!data.moto) data.moto = {};
                    data.moto.plate = getValue('motoPlate').toUpperCase();
                    data.moto.model = getValue('motoModel');
                    data.moto.year = getValue('motoYear');
                    data.moto.color = getValue('motoColor');
                    data.moto.alvara = getValue('motoAlvara');
                    data.moto.capacete = getValue('motoCapacete');
                    data.moto.photos = motoPhotos;
                    data.moto.photosDeleteHashes = motoPhotosDeleteHashes;
                }
                
                // Preferências
                if (!data.preferences) data.preferences = {};
                data.preferences.notifyWhatsApp = document.getElementById('notifyWhatsApp')?.checked || false;
                data.preferences.autoDarkMode = document.getElementById('autoDarkMode')?.checked || false;
                data.preferences.longRides = document.getElementById('longRides')?.checked || false;
                
                // Documentos
                data.documents = uploadedDocuments;
                
                // Status
                data.status = document.getElementById('deactivateAccount')?.checked ? 'inactive' : 'available';
                data.lastUpdate = new Date().toISOString();
                
                // Estatísticas
                if (!data.stats) {
                    data.stats = {
                        totalRides: Math.floor(Math.random() * 200) + 50,
                        rating: (Math.random() * 1 + 4).toFixed(1)
                    };
                }
                
                // Salvar
                saveProfileToLocalStorage(data);
                userData = data;
                
                // Atualizar UI
                updateProfileDisplay(data);
                
                showToast('Sucesso!', 'Perfil atualizado com sucesso', 'success');
                
            } catch (error) {
                console.error('❌ Erro ao salvar:', error);
                showToast('Erro', 'Não foi possível salvar', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // ==========================================
        // VALIDAÇÃO
        // ==========================================
        
        function validateForm() {
            let valid = true;
            
            // Campos obrigatórios
            const required = ['fullName', 'cpf', 'phone'];
            
            if (currentUserType === 'taxi') {
                required.push('plate', 'carModel', 'carYear', 'carColor');
            } else {
                required.push('motoPlate', 'motoModel', 'motoYear', 'motoColor');
            }
            
            required.forEach(id => {
                const el = document.getElementById(id);
                if (el && !el.value.trim()) {
                    el.classList.add('error');
                    valid = false;
                } else if (el) {
                    el.classList.remove('error');
                }
            });
            
            if (!valid) {
                showToast('Atenção', 'Preencha todos os campos obrigatórios', 'error');
                return false;
            }
            
            return true;
        }
        
        // ==========================================
        // UPDATE DISPLAY
        // ==========================================
        
        function updateProfileDisplay(data) {
            const name = data.fullName || 'Motorista';
            const initials = getInitials(name);
            const email = data.email || 'motorista@email.com';
            
            setText('displayName', name);
            setText('displayEmail', email);
            setText('navAvatar', initials);
            
            // Stats
            setText('statRides', data.stats?.totalRides || 0);
            setText('statRating', data.stats?.rating || '5.0');
            
            const created = data.createdAt ? new Date(data.createdAt) : new Date();
            setText('statSince', created.getFullYear());
            
            // Status
            const statusEl = document.getElementById('profileStatus');
            if (statusEl) {
                if (data.status === 'inactive') {
                    statusEl.className = 'profile-status inactive';
                    statusEl.innerHTML = '<i class="fas fa-circle"></i><span>Inativo</span>';
                } else {
                    statusEl.className = 'profile-status';
                    statusEl.innerHTML = '<i class="fas fa-circle"></i><span>Disponível</span>';
                }
            }
        }
        
        function setText(id, text) {
            const el = document.getElementById(id);
            if (el) el.textContent = text;
        }
        
        function getInitials(name) {
            if (!name || name === 'Motorista') return 'TX';
            return name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
        }
        
        // ==========================================
        // RESET FORM
        // ==========================================
        
        function resetForm() {
            if (confirm('Descartar alterações não salvas?')) {
                loadUserProfile();
                showToast('Info', 'Formulário restaurado', 'info');
            }
        }
        
        // ==========================================
        // LOGOUT
        // ==========================================
        
        function logout() {
            if (confirm('Deseja realmente sair?')) {
                window.location.href = 'login.html';
            }
        }
        
        // ==========================================
        // DELETE ACCOUNT
        // ==========================================
        
        async function deleteAccount() {
            if (!confirm('⚠️ ATENÇÃO: Esta ação não pode ser desfeita!\n\nDeseja realmente excluir sua conta?')) return;
            if (!confirm('❌ Todos seus dados serão permanentemente removidos.\n\nConfirma a exclusão?')) return;
            
            showLoading(true, 'Excluindo conta...');
            
            try {
                // Deletar todas as imagens do Imgur
                if (USE_IMGUR) {
                    // Foto de perfil
                    const data = loadProfileFromLocalStorage();
                    if (data?.photoDeleteHash) {
                        await deleteFromImgur(data.photoDeleteHash);
                    }
                    
                    // Fotos do táxi
                    if (taxiPhotosDeleteHashes) {
                        for (const hash of taxiPhotosDeleteHashes) {
                            if (hash) await deleteFromImgur(hash);
                        }
                    }
                    
                    // Fotos da moto
                    if (motoPhotosDeleteHashes) {
                        for (const hash of motoPhotosDeleteHashes) {
                            if (hash) await deleteFromImgur(hash);
                        }
                    }
                }
                
                // Remover do localStorage
                localStorage.removeItem(USER_DATA_KEY);
                
                showToast('Conta excluída', 'Redirecionando...', 'success');
                
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
                
            } catch (error) {
                console.error('Erro ao excluir conta:', error);
                showLoading(false);
                showToast('Erro', 'Não foi possível excluir a conta', 'error');
            }
        }
        
        // ==========================================
        // POPULAR ANOS
        // ==========================================
        
        function populateYears() {
            const currentYear = new Date().getFullYear();
            
            // Anos para táxi
            const taxiYearSelect = document.getElementById('carYear');
            if (taxiYearSelect) {
                taxiYearSelect.innerHTML = '<option value="">Selecione</option>';
                for (let year = currentYear; year >= 2000; year--) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    taxiYearSelect.appendChild(option);
                }
            }
            
            // Anos para moto
            const motoYearSelect = document.getElementById('motoYear');
            if (motoYearSelect) {
                motoYearSelect.innerHTML = '<option value="">Selecione</option>';
                for (let year = currentYear; year >= 2000; year--) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    motoYearSelect.appendChild(option);
                }
            }
        }
        
        // ==========================================
        // TOAST
        // ==========================================
        
        function showToast(title, message, type = 'info') {
            const toastEl = document.getElementById('toast');
            if (!toastEl) return;
            
            const iconEl = toastEl.querySelector('.toast-icon i');
            const titleEl = document.getElementById('toastTitle');
            const msgEl = document.getElementById('toastMessage');
            
            titleEl.textContent = title;
            msgEl.textContent = message;
            
            toastEl.className = 'toast show';
            toastEl.classList.add(type);
            
            if (iconEl) {
                if (type === 'success') iconEl.className = 'fas fa-check-circle';
                else if (type === 'error') iconEl.className = 'fas fa-exclamation-circle';
                else if (type === 'warning') iconEl.className = 'fas fa-exclamation-triangle';
                else iconEl.className = 'fas fa-info-circle';
            }
            
            setTimeout(() => {
                toastEl.classList.remove('show');
            }, 3500);
        }
        
        // ==========================================
        // LOADING
        // ==========================================
        
        function showLoading(show, message = 'Processando...') {
            const overlay = document.getElementById('loadingOverlay');
            const msgEl = document.getElementById('loadingMessage');
            
            if (overlay) {
                if (show) {
                    if (msgEl) msgEl.textContent = message || 'Processando...';
                    overlay.classList.add('active');
                } else {
                    overlay.classList.remove('active');
                }
            }
        }
        
        // ==========================================
        // EVENT LISTENERS
        // ==========================================
        
        function setupEventListeners() {
            // Mobile menu
            const mobileBtn = document.getElementById('mobileMenuBtn');
            if (mobileBtn) {
                mobileBtn.addEventListener('click', function() {
                    alert('Menu mobile em desenvolvimento');
                });
            }
            
            // Desativar conta
            const deactivateCheck = document.getElementById('deactivateAccount');
            if (deactivateCheck) {
                deactivateCheck.addEventListener('change', function() {
                    const status = this.checked ? 'inactive' : 'available';
                    const statusEl = document.getElementById('profileStatus');
                    if (statusEl) {
                        if (status === 'inactive') {
                            statusEl.className = 'profile-status inactive';
                            statusEl.innerHTML = '<i class="fas fa-circle"></i><span>Inativo</span>';
                        } else {
                            statusEl.className = 'profile-status';
                            statusEl.innerHTML = '<i class="fas fa-circle"></i><span>Disponível</span>';
                        }
                    }
                    
                    showToast(
                        status === 'inactive' ? 'Conta desativada' : 'Conta ativada',
                        status === 'inactive' ? 'Você não receberá novas corridas' : 'Você está disponível para corridas',
                        'info'
                    );
                });
            }
        }
        
        // ==========================================
        // MASCARAS
        // ==========================================
        
        function maskCPF(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.substring(0, 11);
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        }
        
        function maskPhone(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.substring(0, 11);
            if (value.length === 11) {
                value = value.replace(/^(\d{2})(\d{5})(\d{4})$/, '($1) $2-$3');
            } else if (value.length === 10) {
                value = value.replace(/^(\d{2})(\d{4})(\d{4})$/, '($1) $2-$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
            }
            e.target.value = value;
        }
        
        function maskPlate(e) {
            let value = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
            value = value.substring(0, 7);
            if (value.length === 7) {
                if (/^[A-Z]{3}[0-9][A-Z][0-9]{2}$/.test(value)) {
                    value = value.replace(/^([A-Z]{3})([0-9])([A-Z])([0-9]{2})$/, '$1$2$3$4');
                } else {
                    value = value.replace(/^([A-Z]{3})(\d{4})$/, '$1-$2');
                }
            } else if (value.length > 3) {
                value = value.replace(/^([A-Z]{3})(.+)$/, '$1-$2');
            }
            e.target.value = value;
        }
        
        // ==========================================
        // INITIALIZATION
        // ==========================================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Perfil do Motorista - Inicializado');
            console.log('📸 Upload Imgur:', USE_IMGUR ? 'Ativado' : 'Desativado');
            
            // Populate anos
            populateYears();
            
            // Setup listeners
            setupEventListeners();
            
            // Adicionar máscaras
            const cpfInput = document.getElementById('cpf');
            if (cpfInput) cpfInput.addEventListener('input', maskCPF);
            
            const phoneInput = document.getElementById('phone');
            if (phoneInput) phoneInput.addEventListener('input', maskPhone);
            
            const plateInput = document.getElementById('plate');
            if (plateInput) plateInput.addEventListener('input', maskPlate);
            
            const motoPlateInput = document.getElementById('motoPlate');
            if (motoPlateInput) motoPlateInput.addEventListener('input', maskPlate);
            
            // Carregar perfil
            loadUserProfile();
        });
        
        // ==========================================
        // EXPOR FUNÇÕES
        // ==========================================
        
        window.handlePhotoUpload = handlePhotoUpload;
        window.handleVehiclePhoto = handleVehiclePhoto;
        window.removeVehiclePhoto = removeVehiclePhoto;
        window.handleMotoPhoto = handleMotoPhoto;
        window.removeMotoPhoto = removeMotoPhoto;
        window.handleDocumentUpload = handleDocumentUpload;
        window.setVehicleType = setVehicleType;
        window.saveProfile = saveProfile;
        window.resetForm = resetForm;
        window.logout = logout;
        window.deleteAccount = deleteAccount;
        window.showToast = showToast;
    </script>
</body>
</html>