<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TaxiBF - Perfil do Motorista</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --taxi-yellow: #FFC400;
            --dark-graphite: #1C1C1C;
            --darker: #121212;
            --white: #FFFFFF;
            --gray: #2A2A2A;
            --available: #2ECC71;
            --busy: #E74C3C;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--darker);
            color: var(--white);
            min-height: 100vh;
        }

        .navbar {
            background: var(--dark-graphite);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 0.8rem 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-back {
            background: none;
            border: none;
            color: var(--white);
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .btn-back:hover {
            color: var(--taxi-yellow);
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--dark-graphite);
        }

        .btn-logout {
            background: none;
            border: none;
            color: #888;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
        }

        .btn-logout:hover {
            color: var(--busy);
        }

        .main-content {
            margin-top: 80px;
            padding: 2rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .page-header h1 i {
            color: var(--taxi-yellow);
        }

        /* Profile Card */
        .profile-card {
            background: var(--dark-graphite);
            border-radius: 24px;
            padding: 2rem;
            border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 2rem;
        }

        .photo-section {
            display: flex;
            align-items: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .photo-upload-container {
            position: relative;
            width: 150px;
            height: 150px;
        }

        .profile-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--taxi-yellow);
            display: none;
        }

        .profile-placeholder {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--taxi-yellow), #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 800;
            color: var(--dark-graphite);
            border: 4px solid var(--taxi-yellow);
        }

        .photo-overlay {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 40px;
            height: 40px;
            background: var(--taxi-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 3px solid var(--dark-graphite);
        }

        .photo-overlay i {
            color: var(--dark-graphite);
        }

        #fileInput {
            display: none;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
        }

        .profile-email {
            color: #888;
            margin-bottom: 0.5rem;
        }

        .profile-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(46, 204, 113, 0.2);
            color: var(--available);
            padding: 0.5rem 1.2rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Vehicle Type Selector */
        .vehicle-type-selector {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
        }

        .vehicle-type-card {
            flex: 1;
            background: rgba(255,255,255,0.03);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .vehicle-type-card i {
            font-size: 2.5rem;
            color: #888;
        }

        .vehicle-type-card.active {
            background: rgba(255,196,0,0.1);
            border-color: var(--taxi-yellow);
        }

        .vehicle-type-card.active i {
            color: var(--taxi-yellow);
        }

        /* Form Sections */
        .form-section {
            background: var(--dark-graphite);
            border-radius: 24px;
            padding: 2rem;
            border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255,255,255,0.05);
        }

        .section-header i {
            color: var(--taxi-yellow);
            font-size: 1.3rem;
        }

        .section-header h2 {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #aaa;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .required {
            color: var(--busy);
        }

        input, select, textarea {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 14px;
            padding: 0.9rem 1.2rem;
            color: var(--white);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--taxi-yellow);
            background: rgba(255,255,255,0.08);
        }

        input::placeholder {
            color: #666;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 12 12'%3E%3Cpath fill='%23FFC400' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1.2rem center;
            padding-right: 3rem;
        }

        /* Photos Grid */
        .photos-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.8rem;
            margin-top: 0.5rem;
        }

        .photo-upload-box {
            aspect-ratio: 1/1;
            background: rgba(255,255,255,0.03);
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .photo-upload-box:hover {
            border-color: var(--taxi-yellow);
            background: rgba(255,196,0,0.05);
        }

        .photo-upload-box.has-image {
            border-style: solid;
            border-color: var(--taxi-yellow);
        }

        .photo-upload-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
        }

        .photo-upload-box i {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 0.3rem;
        }

        .photo-upload-box span {
            font-size: 0.7rem;
            color: #888;
            text-align: center;
            padding: 0 0.3rem;
        }

        .photo-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 30px;
            height: 30px;
            background: var(--busy);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        /* Document Upload */
        .document-upload {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.2rem;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            border: 2px dashed rgba(255,255,255,0.1);
            cursor: pointer;
            transition: all 0.3s;
        }

        .document-upload:hover {
            border-color: var(--taxi-yellow);
            background: rgba(255,196,0,0.05);
        }

        .document-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,196,0,0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--taxi-yellow);
            font-size: 1.5rem;
        }

        .document-info {
            flex: 1;
        }

        .document-info h4 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .document-info p {
            font-size: 0.8rem;
            color: #888;
        }

        .document-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.4rem 1rem;
            border-radius: 30px;
            background: rgba(243, 156, 18, 0.1);
            color: #F39C12;
        }

        /* Toggle Switch */
        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.2rem;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 32px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.1);
            transition: 0.3s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background: var(--taxi-yellow);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(28px);
            background: var(--dark-graphite);
        }

        /* Buttons */
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .btn-primary {
            padding: 1rem 2.5rem;
            border: none;
            background: var(--taxi-yellow);
            color: var(--dark-graphite);
            font-weight: 700;
            border-radius: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.95rem;
        }

        .btn-secondary {
            padding: 1rem 2rem;
            border: 2px solid rgba(255,255,255,0.2);
            background: transparent;
            color: var(--white);
            font-weight: 600;
            border-radius: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .btn-secondary:hover {
            border-color: var(--taxi-yellow);
            color: var(--taxi-yellow);
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(18,18,18,0.98);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,196,0,0.2);
            border-radius: 50%;
            border-top-color: var(--taxi-yellow);
            animation: spin 1s linear infinite;
            margin-bottom: 1.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dark-graphite);
            border-left: 4px solid var(--taxi-yellow);
            padding: 1.2rem 1.5rem;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            gap: 1rem;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 10000;
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left-color: var(--available);
        }

        .toast.error {
            border-left-color: var(--busy);
        }

        .toast-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,196,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--taxi-yellow);
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .photos-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .photo-section {
                justify-content: center;
                text-align: center;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn-primary, .btn-secondary {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .photos-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .vehicle-type-selector {
                flex-direction: column;
            }
        }

        input.error {
            border-color: var(--busy);
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <a href="dashboard-taxi.html" class="btn-back">
            <i class="fas fa-arrow-left"></i>
            <span>Voltar</span>
        </a>
        
        <div style="display: flex; align-items: center; gap: 1rem;">
            <div class="user-avatar" id="navAvatar">TX</div>
            <button class="btn-logout" onclick="logout()" title="Sair">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-header">
            <h1><i class="fas fa-id-card"></i> Meu Perfil</h1>
        </div>

        <!-- Profile Card -->
        <div class="profile-card">
            <div class="photo-section">
                <div class="photo-upload-container">
                    <div class="profile-placeholder" id="profilePlaceholder">
                        TX
                    </div>
                    <img src="" alt="Foto de perfil" class="profile-photo" id="profilePhoto">
                    <label class="photo-overlay" for="fileInput">
                        <i class="fas fa-camera"></i>
                    </label>
                    <input type="file" id="fileInput" accept="image/*" onchange="handlePhotoUpload(event)">
                </div>
                
                <div class="profile-info">
                    <div class="profile-name" id="displayName">-</div>
                    <div class="profile-email" id="displayEmail">-</div>
                    <div class="profile-status" id="profileStatus">
                        <i class="fas fa-circle"></i> Dispon√≠vel
                    </div>
                </div>
            </div>
        </div>

        <!-- Tipo de Ve√≠culo -->
        <div class="form-section">
            <div class="section-header">
                <i class="fas fa-motorcycle"></i>
                <h2>Tipo de Servi√ßo</h2>
            </div>
            
            <div class="vehicle-type-selector">
                <div class="vehicle-type-card active" id="typeTaxi" onclick="setVehicleType('taxi')">
                    <i class="fas fa-taxi"></i>
                    <span>T√°xi</span>
                </div>
                <div class="vehicle-type-card" id="typeMoto" onclick="setVehicleType('moto')">
                    <i class="fas fa-motorcycle"></i>
                    <span>Moto T√°xi</span>
                </div>
            </div>
        </div>

        <!-- Dados Pessoais -->
        <div class="form-section">
            <div class="section-header">
                <i class="fas fa-user"></i>
                <h2>Dados Pessoais</h2>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Nome Completo <span class="required">*</span></label>
                    <input type="text" id="fullName" placeholder="Digite seu nome completo">
                </div>
                <div class="form-group">
                    <label>CPF <span class="required">*</span></label>
                    <input type="text" id="cpf" placeholder="000.000.000-00" maxlength="14">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Telefone <span class="required">*</span></label>
                    <input type="tel" id="phone" placeholder="(11) 98765-4321">
                </div>
                <div class="form-group">
                    <label>E-mail</label>
                    <input type="email" id="email" placeholder="seu@email.com" readonly style="background: rgba(255,255,255,0.02);">
                </div>
            </div>
        </div>

        <!-- Se√ß√£o T√°xi -->
        <div id="vehicleTaxiSection">
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-taxi"></i>
                    <h2>Dados do T√°xi</h2>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Placa <span class="required">*</span></label>
                        <input type="text" id="plate" placeholder="ABC-1234" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>Modelo <span class="required">*</span></label>
                        <input type="text" id="carModel" placeholder="Ex: Toyota Corolla">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Ano <span class="required">*</span></label>
                        <select id="carYear">
                            <option value="">Selecione o ano</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cor <span class="required">*</span></label>
                        <select id="carColor">
                            <option value="">Selecione a cor</option>
                            <option value="Preto">Preto</option>
                            <option value="Branco">Branco</option>
                            <option value="Prata">Prata</option>
                            <option value="Cinza">Cinza</option>
                            <option value="Vermelho">Vermelho</option>
                            <option value="Azul">Azul</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>N√∫mero do Alvar√°</label>
                        <input type="text" id="alvara" placeholder="Ex: 12345/2025">
                    </div>
                    <div class="form-group">
                        <label>Permiss√£o</label>
                        <input type="text" id="permissao" placeholder="N√∫mero da permiss√£o">
                    </div>
                </div>

                <div class="form-group full-width">
                    <label>Fotos do Ve√≠culo (5 √¢ngulos)</label>
                    <div class="photos-grid" id="vehiclePhotos">
                        <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto0').click()">
                            <i class="fas fa-plus"></i>
                            <span>Frente</span>
                            <input type="file" id="vehiclePhoto0" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 0)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto1').click()">
                            <i class="fas fa-plus"></i>
                            <span>Traseira</span>
                            <input type="file" id="vehiclePhoto1" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 1)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto2').click()">
                            <i class="fas fa-plus"></i>
                            <span>Lateral</span>
                            <input type="file" id="vehiclePhoto2" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 2)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto3').click()">
                            <i class="fas fa-plus"></i>
                            <span>Interior</span>
                            <input type="file" id="vehiclePhoto3" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 3)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('vehiclePhoto4').click()">
                            <i class="fas fa-plus"></i>
                            <span>Placa</span>
                            <input type="file" id="vehiclePhoto4" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, 4)">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o Moto -->
        <div id="vehicleMotoSection" style="display: none;">
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-motorcycle"></i>
                    <h2>Dados da Moto</h2>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Placa <span class="required">*</span></label>
                        <input type="text" id="motoPlate" placeholder="ABC-1234" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>Modelo <span class="required">*</span></label>
                        <input type="text" id="motoModel" placeholder="Ex: Honda CB500X">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Ano <span class="required">*</span></label>
                        <select id="motoYear">
                            <option value="">Selecione o ano</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cor <span class="required">*</span></label>
                        <select id="motoColor">
                            <option value="">Selecione a cor</option>
                            <option value="Preta">Preta</option>
                            <option value="Branca">Branca</option>
                            <option value="Vermelha">Vermelha</option>
                            <option value="Azul">Azul</option>
                            <option value="Cinza">Cinza</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>N√∫mero do Alvar√°</label>
                        <input type="text" id="motoAlvara" placeholder="Ex: 12345/2025">
                    </div>
                    <div class="form-group">
                        <label>Capacete Extra</label>
                        <select id="motoCapacete">
                            <option value="">Possui capacete para passageiro?</option>
                            <option value="sim">Sim</option>
                            <option value="nao">N√£o</option>
                        </select>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label>Fotos da Moto</label>
                    <div class="photos-grid" id="motoPhotos">
                        <div class="photo-upload-box" onclick="document.getElementById('motoPhoto0').click()">
                            <i class="fas fa-plus"></i>
                            <span>Frente</span>
                            <input type="file" id="motoPhoto0" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 0)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('motoPhoto1').click()">
                            <i class="fas fa-plus"></i>
                            <span>Lateral</span>
                            <input type="file" id="motoPhoto1" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 1)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('motoPhoto2').click()">
                            <i class="fas fa-plus"></i>
                            <span>Traseira</span>
                            <input type="file" id="motoPhoto2" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 2)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('motoPhoto3').click()">
                            <i class="fas fa-plus"></i>
                            <span>Placa</span>
                            <input type="file" id="motoPhoto3" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 3)">
                        </div>
                        <div class="photo-upload-box" onclick="document.getElementById('motoPhoto4').click()">
                            <i class="fas fa-plus"></i>
                            <span>Capacete</span>
                            <input type="file" id="motoPhoto4" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, 4)">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Documentos -->
        <div class="form-section">
            <div class="section-header">
                <i class="fas fa-file-alt"></i>
                <h2>Documentos</h2>
            </div>
            
            <div class="form-group full-width" style="margin-bottom: 1rem;">
                <label>CNH <span class="required">*</span></label>
                <div class="document-upload" onclick="document.getElementById('cnhFile').click()">
                    <div class="document-icon">
                        <i class="fas fa-id-card"></i>
                    </div>
                    <div class="document-info">
                        <h4>Carteira Nacional de Habilita√ß√£o</h4>
                        <p id="cnhStatus">Nenhum arquivo enviado</p>
                    </div>
                    <div class="document-status" id="cnhBadge">
                        <i class="fas fa-clock"></i> Pendente
                    </div>
                    <input type="file" id="cnhFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'cnh')">
                </div>
            </div>

            <div class="form-group full-width" style="margin-bottom: 1rem;">
                <label>CRLV</label>
                <div class="document-upload" onclick="document.getElementById('crlvFile').click()">
                    <div class="document-icon">
                        <i class="fas fa-file-invoice"></i>
                    </div>
                    <div class="document-info">
                        <h4>Certificado de Registro e Licenciamento</h4>
                        <p id="crlvStatus">Nenhum arquivo enviado</p>
                    </div>
                    <div class="document-status" id="crlvBadge">
                        <i class="fas fa-clock"></i> Pendente
                    </div>
                    <input type="file" id="crlvFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'crlv')">
                </div>
            </div>

            <div class="form-group full-width">
                <label>Comprovante de Resid√™ncia</label>
                <div class="document-upload" onclick="document.getElementById('addressFile').click()">
                    <div class="document-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="document-info">
                        <h4>Comprovante de Endere√ßo</h4>
                        <p id="addressStatus">Nenhum arquivo enviado</p>
                    </div>
                    <div class="document-status" id="addressBadge">
                        <i class="fas fa-clock"></i> Pendente
                    </div>
                    <input type="file" id="addressFile" accept="image/*,.pdf" style="display: none;" onchange="handleDocumentUpload(event, 'address')">
                </div>
            </div>
        </div>

        <!-- Prefer√™ncias -->
        <div class="form-section">
            <div class="section-header">
                <i class="fas fa-cog"></i>
                <h2>Prefer√™ncias</h2>
            </div>
            
            <div class="toggle-group">
                <div class="toggle-info">
                    <h4>Notifica√ß√µes WhatsApp</h4>
                    <p style="color: #888; font-size: 0.85rem;">Receber avisos de novas corridas</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="notifyWhatsApp">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="toggle-group" style="margin-top: 1rem;">
                <div class="toggle-info">
                    <h4>Desativar Conta</h4>
                    <p style="color: #888; font-size: 0.85rem;">N√£o receber novas solicita√ß√µes</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="deactivateAccount">
                    <span class="toggle-slider" style="background: rgba(231, 76, 60, 0.2);"></span>
                </label>
            </div>
        </div>

        <!-- Bot√µes -->
        <div class="form-actions">
            <button class="btn-secondary" onclick="resetForm()">
                <i class="fas fa-undo-alt"></i>
                Limpar
            </button>
            <button class="btn-primary" onclick="saveProfile()" id="saveBtn">
                <i class="fas fa-save"></i>
                Salvar Perfil
            </button>
        </div>
    </main>

    <!-- Toast -->
    <div class="toast" id="toast">
        <div class="toast-icon">
            <i class="fas fa-info-circle"></i>
        </div>
        <div class="toast-content">
            <h4 id="toastTitle" style="margin-bottom: 0.2rem;">Notifica√ß√£o</h4>
            <p id="toastMessage" style="color: #aaa;">Mensagem</p>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p style="color: #888;" id="loadingMessage">Enviando imagem para Imgur...</p>
    </div>

    <script>
        // ==========================================
        // ‚úÖ COLE SEU CLIENT ID DO IMGUR AQUI
        // ==========================================
        const IMGUR_CLIENT_ID = ''; // <-- COLE O SEU CLIENT ID AQUI!
        
        // ==========================================
        // VERIFICA√á√ÉO CR√çTICA
        // ==========================================
        if (!IMGUR_CLIENT_ID) {
            alert('‚ö†Ô∏è ATEN√á√ÉO: Voc√™ precisa configurar seu Client ID do Imgur!\n\n1. Acesse: https://api.imgur.com/oauth2/addclient\n2. Crie uma aplica√ß√£o (OAuth 2 without callback)\n3. Copie o Client ID\n4. Cole na linha 24 do c√≥digo');
        }

        // ==========================================
        // CONSTANTES
        // ==========================================
        const USER_DATA_KEY = 'taxiBF_profile';
        
        // ==========================================
        // VARI√ÅVEIS GLOBAIS
        // ==========================================
        let userData = {
            fullName: '',
            cpf: '',
            phone: '',
            email: '',
            userType: 'taxi',
            photoURL: null,
            photoDeleteHash: null,
            taxi: {
                plate: '',
                model: '',
                year: '',
                color: '',
                alvara: '',
                permissao: '',
                photos: [null, null, null, null, null],
                photosDeleteHashes: [null, null, null, null, null]
            },
            moto: {
                plate: '',
                model: '',
                year: '',
                color: '',
                alvara: '',
                capacete: '',
                photos: [null, null, null, null, null],
                photosDeleteHashes: [null, null, null, null, null]
            },
            documents: {},
            preferences: {
                notifyWhatsApp: true
            },
            status: 'available'
        };

        let taxiPhotos = [null, null, null, null, null];
        let taxiPhotosDeleteHashes = [null, null, null, null, null];
        let motoPhotos = [null, null, null, null, null];
        let motoPhotosDeleteHashes = [null, null, null, null, null];

        // ==========================================
        // FUN√á√ÉO DE UPLOAD IMGUR - 100% FUNCIONAL
        // ==========================================
        async function uploadToImgur(file) {
            if (!IMGUR_CLIENT_ID) {
                throw new Error('Client ID do Imgur n√£o configurado');
            }

            const formData = new FormData();
            formData.append('image', file);
            formData.append('type', 'file');
            formData.append('name', `taxibf_${Date.now()}.jpg`);
            formData.append('title', `TaxiBF_${Date.now()}`);

            try {
                console.log('üì§ Enviando para Imgur...');
                
                const response = await fetch('https://api.imgur.com/3/image', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Client-ID ${IMGUR_CLIENT_ID}`
                    },
                    body: formData
                });

                const data = await response.json();
                
                if (data.success) {
                    console.log('‚úÖ Upload IMGUR realizado:', data.data.link);
                    return {
                        url: data.data.link,
                        deleteHash: data.data.deletehash,
                        id: data.data.id
                    };
                } else {
                    console.error('‚ùå Erro Imgur:', data.data.error);
                    throw new Error(data.data.error || 'Erro no upload');
                }
            } catch (error) {
                console.error('‚ùå Exce√ß√£o no upload:', error);
                throw error;
            }
        }

        // ==========================================
        // DELETAR DO IMGUR
        // ==========================================
        async function deleteFromImgur(deleteHash) {
            if (!deleteHash || !IMGUR_CLIENT_ID) return;
            
            try {
                const response = await fetch(`https://api.imgur.com/3/image/${deleteHash}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Client-ID ${IMGUR_CLIENT_ID}`
                    }
                });
                const data = await response.json();
                console.log('üóëÔ∏è Imagem deletada:', data);
                return data;
            } catch (error) {
                console.error('Erro ao deletar:', error);
            }
        }

        // ==========================================
        // FOTO DE PERFIL - FUNCIONAL
        // ==========================================
        async function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showToast('Erro', 'Selecione uma imagem', 'error');
                return;
            }

            if (file.size > 5 * 1024 * 1024) {
                showToast('Erro', 'Imagem deve ter at√© 5MB', 'error');
                return;
            }

            showLoading(true, 'Enviando foto...');

            try {
                // Upload para Imgur
                const result = await uploadToImgur(file);
                
                // Deletar foto antiga
                if (userData.photoDeleteHash) {
                    await deleteFromImgur(userData.photoDeleteHash);
                }

                // Atualizar dados
                userData.photoURL = result.url;
                userData.photoDeleteHash = result.deleteHash;
                
                // Salvar no localStorage
                saveToLocalStorage();

                // Atualizar UI
                displayProfilePhoto(result.url);
                
                showToast('Sucesso', 'Foto de perfil atualizada', 'success');
                
            } catch (error) {
                console.error(error);
                showToast('Erro', 'Falha ao enviar: ' + error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }

        function displayProfilePhoto(url) {
            const photo = document.getElementById('profilePhoto');
            const placeholder = document.getElementById('profilePlaceholder');
            
            if (photo && url) {
                photo.src = url;
                photo.style.display = 'block';
                placeholder.style.display = 'none';
                photo.onerror = function() {
                    photo.style.display = 'none';
                    placeholder.style.display = 'flex';
                    showToast('Aviso', 'Erro ao carregar imagem', 'warning');
                };
            }
        }

        // ==========================================
        // FOTOS DO T√ÅXI - FUNCIONAL
        // ==========================================
        async function handleVehiclePhoto(event, index) {
            const file = event.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showToast('Erro', 'Selecione uma imagem', 'error');
                return;
            }

            showLoading(true, 'Enviando foto do ve√≠culo...');

            try {
                const result = await uploadToImgur(file);
                
                if (taxiPhotosDeleteHashes[index]) {
                    await deleteFromImgur(taxiPhotosDeleteHashes[index]);
                }

                taxiPhotos[index] = result.url;
                taxiPhotosDeleteHashes[index] = result.deleteHash;
                
                userData.taxi.photos = taxiPhotos;
                userData.taxi.photosDeleteHashes = taxiPhotosDeleteHashes;
                saveToLocalStorage();

                displayVehiclePhoto(result.url, index);
                showToast('Sucesso', 'Foto adicionada', 'success');
                
            } catch (error) {
                showToast('Erro', error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }

        function displayVehiclePhoto(url, index) {
            const boxes = document.querySelectorAll('#vehiclePhotos .photo-upload-box');
            if (!boxes[index]) return;
            
            const box = boxes[index];
            const labels = ['Frente', 'Traseira', 'Lateral', 'Interior', 'Placa'];
            
            box.innerHTML = `
                <img src="${url}" alt="Foto ${labels[index]}">
                <button class="photo-remove" onclick="removeVehiclePhoto(event, ${index})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            box.classList.add('has-image');
        }

        async function removeVehiclePhoto(event, index) {
            event.stopPropagation();
            
            if (!confirm('Remover esta foto?')) return;
            
            showLoading(true, 'Removendo...');
            
            try {
                if (taxiPhotosDeleteHashes[index]) {
                    await deleteFromImgur(taxiPhotosDeleteHashes[index]);
                }
                
                taxiPhotos[index] = null;
                taxiPhotosDeleteHashes[index] = null;
                
                userData.taxi.photos = taxiPhotos;
                userData.taxi.photosDeleteHashes = taxiPhotosDeleteHashes;
                saveToLocalStorage();
                
                const boxes = document.querySelectorAll('#vehiclePhotos .photo-upload-box');
                const box = boxes[index];
                const labels = ['Frente', 'Traseira', 'Lateral', 'Interior', 'Placa'];
                
                box.innerHTML = `
                    <i class="fas fa-plus"></i>
                    <span>${labels[index]}</span>
                    <input type="file" id="vehiclePhoto${index}" accept="image/*" style="display: none;" onchange="handleVehiclePhoto(event, ${index})">
                `;
                box.classList.remove('has-image');
                
                showToast('Sucesso', 'Foto removida', 'success');
                
            } catch (error) {
                showToast('Erro', error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        // ==========================================
        // FOTOS DA MOTO - FUNCIONAL
        // ==========================================
        async function handleMotoPhoto(event, index) {
            const file = event.target.files[0];
            if (!file) return;

            showLoading(true, 'Enviando foto da moto...');

            try {
                const result = await uploadToImgur(file);
                
                if (motoPhotosDeleteHashes[index]) {
                    await deleteFromImgur(motoPhotosDeleteHashes[index]);
                }

                motoPhotos[index] = result.url;
                motoPhotosDeleteHashes[index] = result.deleteHash;
                
                userData.moto.photos = motoPhotos;
                userData.moto.photosDeleteHashes = motoPhotosDeleteHashes;
                saveToLocalStorage();

                displayMotoPhoto(result.url, index);
                showToast('Sucesso', 'Foto adicionada', 'success');
                
            } catch (error) {
                showToast('Erro', error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }

        function displayMotoPhoto(url, index) {
            const boxes = document.querySelectorAll('#motoPhotos .photo-upload-box');
            if (!boxes[index]) return;
            
            const box = boxes[index];
            const labels = ['Frente', 'Lateral', 'Traseira', 'Placa', 'Capacete'];
            
            box.innerHTML = `
                <img src="${url}" alt="Foto ${labels[index]}">
                <button class="photo-remove" onclick="removeMotoPhoto(event, ${index})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            box.classList.add('has-image');
        }

        async function removeMotoPhoto(event, index) {
            event.stopPropagation();
            if (!confirm('Remover esta foto?')) return;
            
            showLoading(true, 'Removendo...');
            
            try {
                if (motoPhotosDeleteHashes[index]) {
                    await deleteFromImgur(motoPhotosDeleteHashes[index]);
                }
                
                motoPhotos[index] = null;
                motoPhotosDeleteHashes[index] = null;
                
                userData.moto.photos = motoPhotos;
                userData.moto.photosDeleteHashes = motoPhotosDeleteHashes;
                saveToLocalStorage();
                
                const boxes = document.querySelectorAll('#motoPhotos .photo-upload-box');
                const box = boxes[index];
                const labels = ['Frente', 'Lateral', 'Traseira', 'Placa', 'Capacete'];
                
                box.innerHTML = `
                    <i class="fas fa-plus"></i>
                    <span>${labels[index]}</span>
                    <input type="file" id="motoPhoto${index}" accept="image/*" style="display: none;" onchange="handleMotoPhoto(event, ${index})">
                `;
                box.classList.remove('has-image');
                
                showToast('Sucesso', 'Foto removida', 'success');
                
            } catch (error) {
                showToast('Erro', error.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        // ==========================================
        // DOCUMENTOS - FUNCIONAL
        // ==========================================
        async function handleDocumentUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;

            showLoading(true, 'Enviando documento...');

            try {
                let fileURL;
                
                if (file.type.startsWith('image/')) {
                    const result = await uploadToImgur(file);
                    fileURL = result.url;
                } else {
                    // Para PDFs, criar URL local
                    fileURL = URL.createObjectURL(file);
                }

                const docData = {
                    url: fileURL,
                    name: file.name,
                    uploadedAt: new Date().toISOString(),
                    status: 'pending'
                };

                userData.documents[type] = docData;
                saveToLocalStorage();

                // Atualizar UI
                const statusEl = document.getElementById(`${type}Status`);
                const badgeEl = document.getElementById(`${type}Badge`);
                
                if (statusEl) statusEl.textContent = file.name;
                if (badgeEl) {
                    badgeEl.innerHTML = '<i class="fas fa-clock"></i> Aguardando';
                }

                showToast('Sucesso', 'Documento enviado', 'success');
                
            } catch (error) {
                showToast('Erro', error.message, 'error');
            } finally {
                showLoading(false);
                event.target.value = '';
            }
        }

        // ==========================================
        // TIPO DE VE√çCULO
        // ==========================================
        function setVehicleType(type) {
            userData.userType = type;
            saveToLocalStorage();
            
            const taxiCard = document.getElementById('typeTaxi');
            const motoCard = document.getElementById('typeMoto');
            const taxiSection = document.getElementById('vehicleTaxiSection');
            const motoSection = document.getElementById('vehicleMotoSection');
            
            if (type === 'taxi') {
                taxiCard.classList.add('active');
                motoCard.classList.remove('active');
                taxiSection.style.display = 'block';
                motoSection.style.display = 'none';
            } else {
                motoCard.classList.add('active');
                taxiCard.classList.remove('active');
                motoSection.style.display = 'block';
                taxiSection.style.display = 'none';
            }
        }

        // ==========================================
        // LOCALSTORAGE
        // ==========================================
        function saveToLocalStorage() {
            try {
                localStorage.setItem(USER_DATA_KEY, JSON.stringify(userData));
                console.log('‚úÖ Dados salvos');
            } catch (e) {
                console.error('Erro ao salvar:', e);
            }
        }

        function loadFromLocalStorage() {
            try {
                const saved = localStorage.getItem(USER_DATA_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    userData = { ...userData, ...data };
                    
                    // Restaurar arrays
                    if (userData.taxi?.photos) taxiPhotos = [...userData.taxi.photos];
                    if (userData.taxi?.photosDeleteHashes) taxiPhotosDeleteHashes = [...userData.taxi.photosDeleteHashes];
                    if (userData.moto?.photos) motoPhotos = [...userData.moto.photos];
                    if (userData.moto?.photosDeleteHashes) motoPhotosDeleteHashes = [...userData.moto.photosDeleteHashes];
                    
                    console.log('‚úÖ Dados carregados');
                    return true;
                }
            } catch (e) {
                console.error('Erro ao carregar:', e);
            }
            return false;
        }

        // ==========================================
        // PREENCHER FORMUL√ÅRIO
        // ==========================================
        function fillForm() {
            // Dados pessoais
            setValue('fullName', userData.fullName);
            setValue('cpf', userData.cpf);
            setValue('phone', userData.phone);
            setValue('email', userData.email || '');
            
            // T√°xi
            setValue('plate', userData.taxi?.plate || '');
            setValue('carModel', userData.taxi?.model || '');
            setValue('carYear', userData.taxi?.year || '');
            setValue('carColor', userData.taxi?.color || '');
            setValue('alvara', userData.taxi?.alvara || '');
            setValue('permissao', userData.taxi?.permissao || '');
            
            // Moto
            setValue('motoPlate', userData.moto?.plate || '');
            setValue('motoModel', userData.moto?.model || '');
            setValue('motoYear', userData.moto?.year || '');
            setValue('motoColor', userData.moto?.color || '');
            setValue('motoAlvara', userData.moto?.alvara || '');
            setValue('motoCapacete', userData.moto?.capacete || '');
            
            // Prefer√™ncias
            setCheckbox('notifyWhatsApp', userData.preferences?.notifyWhatsApp || false);
            setCheckbox('deactivateAccount', userData.status === 'inactive');
            
            // Perfil
            updateProfileDisplay();
            
            // Fotos
            if (userData.photoURL) displayProfilePhoto(userData.photoURL);
            
            // Fotos do t√°xi
            if (userData.taxi?.photos) {
                userData.taxi.photos.forEach((url, index) => {
                    if (url) displayVehiclePhoto(url, index);
                });
            }
            
            // Fotos da moto
            if (userData.moto?.photos) {
                userData.moto.photos.forEach((url, index) => {
                    if (url) displayMotoPhoto(url, index);
                });
            }
            
            // Documentos
            if (userData.documents) {
                if (userData.documents.cnh) {
                    document.getElementById('cnhStatus').textContent = userData.documents.cnh.name;
                    document.getElementById('cnhBadge').innerHTML = '<i class="fas fa-clock"></i> Aguardando';
                }
                if (userData.documents.crlv) {
                    document.getElementById('crlvStatus').textContent = userData.documents.crlv.name;
                    document.getElementById('crlvBadge').innerHTML = '<i class="fas fa-clock"></i> Aguardando';
                }
                if (userData.documents.address) {
                    document.getElementById('addressStatus').textContent = userData.documents.address.name;
                    document.getElementById('addressBadge').innerHTML = '<i class="fas fa-clock"></i> Aguardando';
                }
            }
            
            // Tipo de ve√≠culo
            setVehicleType(userData.userType || 'taxi');
        }

        function setValue(id, value) {
            const el = document.getElementById(id);
            if (el) el.value = value || '';
        }

        function setCheckbox(id, checked) {
            const el = document.getElementById(id);
            if (el) el.checked = checked;
        }

        function getValue(id) {
            const el = document.getElementById(id);
            return el ? el.value.trim() : '';
        }

        function updateProfileDisplay() {
            const name = userData.fullName || 'Motorista';
            const initials = name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase() || 'TX';
            
            setText('displayName', userData.fullName || '-');
            setText('displayEmail', userData.email || '-');
            setText('navAvatar', initials);
            setText('profilePlaceholder', initials);
        }

        function setText(id, text) {
            const el = document.getElementById(id);
            if (el) el.textContent = text;
        }

        // ==========================================
        // SALVAR PERFIL
        // ==========================================
        function saveProfile() {
            if (!validateForm()) return;

            // Dados pessoais
            userData.fullName = getValue('fullName');
            userData.cpf = getValue('cpf');
            userData.phone = getValue('phone');
            userData.email = getValue('email');
            
            // Dados do t√°xi
            if (userData.userType === 'taxi') {
                userData.taxi = userData.taxi || {};
                userData.taxi.plate = getValue('plate').toUpperCase();
                userData.taxi.model = getValue('carModel');
                userData.taxi.year = getValue('carYear');
                userData.taxi.color = getValue('carColor');
                userData.taxi.alvara = getValue('alvara');
                userData.taxi.permissao = getValue('permissao');
                userData.taxi.photos = taxiPhotos;
                userData.taxi.photosDeleteHashes = taxiPhotosDeleteHashes;
            } else {
                userData.moto = userData.moto || {};
                userData.moto.plate = getValue('motoPlate').toUpperCase();
                userData.moto.model = getValue('motoModel');
                userData.moto.year = getValue('motoYear');
                userData.moto.color = getValue('motoColor');
                userData.moto.alvara = getValue('motoAlvara');
                userData.moto.capacete = getValue('motoCapacete');
                userData.moto.photos = motoPhotos;
                userData.moto.photosDeleteHashes = motoPhotosDeleteHashes;
            }
            
            // Prefer√™ncias
            userData.preferences = userData.preferences || {};
            userData.preferences.notifyWhatsApp = document.getElementById('notifyWhatsApp')?.checked || false;
            userData.status = document.getElementById('deactivateAccount')?.checked ? 'inactive' : 'available';
            
            // Salvar
            saveToLocalStorage();
            updateProfileDisplay();
            
            showToast('Sucesso', 'Perfil salvo com sucesso', 'success');
        }

        // ==========================================
        // VALIDA√á√ÉO
        // ==========================================
        function validateForm() {
            let valid = true;
            
            // Campos obrigat√≥rios
            const required = ['fullName', 'cpf', 'phone'];
            
            if (userData.userType === 'taxi') {
                required.push('plate', 'carModel', 'carYear', 'carColor');
            } else {
                required.push('motoPlate', 'motoModel', 'motoYear', 'motoColor');
            }
            
            required.forEach(id => {
                const el = document.getElementById(id);
                if (el && !el.value.trim()) {
                    el.classList.add('error');
                    valid = false;
                } else if (el) {
                    el.classList.remove('error');
                }
            });
            
            if (!valid) {
                showToast('Aten√ß√£o', 'Preencha todos os campos obrigat√≥rios', 'error');
            }
            
            return valid;
        }

        // ==========================================
        // RESET
        // ==========================================
        function resetForm() {
            if (confirm('Limpar todos os campos n√£o salvos?')) {
                fillForm();
                showToast('Info', 'Formul√°rio restaurado', 'info');
            }
        }

        // ==========================================
        // POPULAR ANOS
        // ==========================================
        function populateYears() {
            const currentYear = new Date().getFullYear();
            
            ['carYear', 'motoYear'].forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">Selecione o ano</option>';
                    for (let year = currentYear; year >= 2000; year--) {
                        const option = document.createElement('option');
                        option.value = year;
                        option.textContent = year;
                        select.appendChild(option);
                    }
                }
            });
        }

        // ==========================================
        // M√ÅSCARAS
        // ==========================================
        function maskCPF(e) {
            let v = e.target.value.replace(/\D/g, '').substring(0, 11);
            v = v.replace(/(\d{3})(\d)/, '$1.$2');
            v = v.replace(/(\d{3})(\d)/, '$1.$2');
            v = v.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = v;
        }

        function maskPhone(e) {
            let v = e.target.value.replace(/\D/g, '').substring(0, 11);
            if (v.length === 11) {
                v = v.replace(/^(\d{2})(\d{5})(\d{4})$/, '($1) $2-$3');
            } else if (v.length === 10) {
                v = v.replace(/^(\d{2})(\d{4})(\d{4})$/, '($1) $2-$3');
            } else if (v.length > 2) {
                v = v.replace(/^(\d{2})(\d)/, '($1) $2');
            }
            e.target.value = v;
        }

        function maskPlate(e) {
            let v = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '').substring(0, 7);
            if (v.length === 7) {
                if (/^[A-Z]{3}[0-9][A-Z][0-9]{2}$/.test(v)) {
                    v = v.replace(/^([A-Z]{3})([0-9])([A-Z])([0-9]{2})$/, '$1$2$3$4');
                } else {
                    v = v.replace(/^([A-Z]{3})(\d{4})$/, '$1-$2');
                }
            } else if (v.length > 3) {
                v = v.replace(/^([A-Z]{3})(.+)$/, '$1-$2');
            }
            e.target.value = v;
        }

        // ==========================================
        // TOAST
        // ==========================================
        function showToast(title, message, type = 'info') {
            const toast = document.getElementById('toast');
            const icon = toast.querySelector('.toast-icon i');
            const titleEl = document.getElementById('toastTitle');
            const msgEl = document.getElementById('toastMessage');
            
            titleEl.textContent = title;
            msgEl.textContent = message;
            
            toast.className = 'toast show ' + type;
            
            if (type === 'success') icon.className = 'fas fa-check-circle';
            else if (type === 'error') icon.className = 'fas fa-exclamation-circle';
            else icon.className = 'fas fa-info-circle';
            
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ==========================================
        // LOADING
        // ==========================================
        function showLoading(show, message = 'Enviando para Imgur...') {
            const overlay = document.getElementById('loadingOverlay');
            const msgEl = document.getElementById('loadingMessage');
            if (overlay) {
                if (show) {
                    if (msgEl) msgEl.textContent = message;
                    overlay.classList.add('active');
                } else {
                    overlay.classList.remove('active');
                }
            }
        }

        // ==========================================
        // LOGOUT
        // ==========================================
        function logout() {
            if (confirm('Deseja sair?')) {
                window.location.href = 'login.html';
            }
        }

        // ==========================================
        // INIT
        // ==========================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Perfil do Motorista');
            
            populateYears();
            
            // Carregar dados
            loadFromLocalStorage();
            fillForm();
            
            // M√°scaras
            document.getElementById('cpf')?.addEventListener('input', maskCPF);
            document.getElementById('phone')?.addEventListener('input', maskPhone);
            document.getElementById('plate')?.addEventListener('input', maskPlate);
            document.getElementById('motoPlate')?.addEventListener('input', maskPlate);
            
            // Status
            const deactivateCheck = document.getElementById('deactivateAccount');
            if (deactivateCheck) {
                deactivateCheck.addEventListener('change', function() {
                    userData.status = this.checked ? 'inactive' : 'available';
                    saveToLocalStorage();
                });
            }
        });

        // ==========================================
        // EXPORT
        // ==========================================
        window.handlePhotoUpload = handlePhotoUpload;
        window.handleVehiclePhoto = handleVehiclePhoto;
        window.removeVehiclePhoto = removeVehiclePhoto;
        window.handleMotoPhoto = handleMotoPhoto;
        window.removeMotoPhoto = removeMotoPhoto;
        window.handleDocumentUpload = handleDocumentUpload;
        window.setVehicleType = setVehicleType;
        window.saveProfile = saveProfile;
        window.resetForm = resetForm;
        window.logout = logout;
    </script>
</body>
</html>